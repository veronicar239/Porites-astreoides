de.genes.OO_RO <- as.data.frame(de.genes.OO_RO)
dim(de.genes.OO_RO)
de.genes.RO_RC <- readRDS(file = "Sid_Symbiont_RO_RC_pval.05.rds")
de.genes.RO_RC <- as.data.frame(de.genes.RO_RC)
dim(de.genes.RO_RC)
de.genes.OC_LC <- readRDS(file = "Sid_Symbiont_OC_LC_pval.05.rds")
de.genes.OC_LC <- as.data.frame(de.genes.OC_LC)
dim(de.genes.OC_LC)
de.genes.OC_RC <- readRDS(file = "Sid_Symbiont_OC_RC_pval.05.rds")
de.genes.OC_RC <- as.data.frame(de.genes.OC_RC)
dim(de.genes.OC_RC)
de.genes.LC_RC <- readRDS(file = "Sid_Symbiont_LC_RC_pval.05.rds")
de.genes.LC_RC <- as.data.frame(de.genes.LC_RC)
dim(de.genes.LC_RC)
# extract row names from DE gene list
rownames(de.genes.LC_RC) <- de.genes.LC_RC[,1]
sigChanges <- rownames(de.genes.LC_RC)[de.genes.LC_RC$pvalue < 0.05 & !is.na(de.genes.LC_RC$pvalue)]
counts_de <- counts.transformed.vst[rownames(counts.transformed.vst) %in% sigChanges,]
dim(counts_de)
pcadata = DESeq2::plotPCA(counts_de, intgroup = c("group"), returnData = TRUE)
percentVar = round(100 * attr(pcadata, "percentVar"))
pca = prcomp(t(assay(counts_de)), center = TRUE, scale. = FALSE)
plot <- DESeq2::plotPCA(counts_de, returnData = TRUE, intgroup = c("group")) %>%
ggplot(aes(x = PC1, y = PC2)) +
geom_point(aes(color = group), size = 1.3) +
stat_ellipse(geom = "polygon", alpha = 1/10, aes(fill = group)) +
scale_color_manual(values = c("dodgerblue", "gold2", "#163343", "firebrick", "forestgreen", "bisque3")) + #chosen.palette
scale_fill_manual(values = c("dodgerblue", "gold2", "#163343", "firebrick", "forestgreen", "bisque3")) +
xlab(paste0("PC1: ",percentVar[1],"% variance")) +
ylab(paste0("PC2: ",percentVar[2],"% variance")) +
labs(title = "Lagoon-Control vs. Reef-Control (4073 genes)") +
labs(color = "Origin.Destination", fill = "Origin.Destination") +
theme_cowplot()
plot
# save plot
pdf("Sid_Symbiont_C_PCA_LC_RC_all-indiv.pdf")
pcadata = DESeq2::plotPCA(counts_de, intgroup = c("group"), returnData = TRUE)
percentVar = round(100 * attr(pcadata, "percentVar"))
pca = prcomp(t(assay(counts_de)), center = TRUE, scale. = FALSE)
plot <- DESeq2::plotPCA(counts_de, returnData = TRUE, intgroup = c("group")) %>%
ggplot(aes(x = PC1, y = PC2)) +
geom_point(aes(color = group), size = 1.3) +
stat_ellipse(geom = "polygon", alpha = 1/10, aes(fill = group)) +
scale_color_manual(values = c("dodgerblue", "gold2", "#163343", "firebrick", "forestgreen", "bisque3")) + #chosen.palette
scale_fill_manual(values = c("dodgerblue", "gold2", "#163343", "firebrick", "forestgreen", "bisque3")) +
xlab(paste0("PC1: ",percentVar[1],"% variance")) +
ylab(paste0("PC2: ",percentVar[2],"% variance")) +
labs(title = "Lagoon-Control vs. Reef-Control (4073 genes)") +
labs(color = "Origin.Destination", fill = "Origin.Destination") +
theme_cowplot()
plot
dev.off()
rownames(de.genes.LC_RC) <- de.genes.LC_RC[,1]
sigChanges <- rownames(de.genes.LC_RC)[de.genes.LC_RC$pvalue < 0.05 & !is.na(de.genes.LC_RC$pvalue)]
# select relevant sample columns for the given pairwise comparison
colnames(counts.transformed.vst)
# extract row names from DE gene list
rownames(de.genes.LC_RC) <- de.genes.LC_RC[,1]
sigChanges <- rownames(de.genes.LC_RC)[de.genes.LC_RC$pvalue < 0.05 & !is.na(de.genes.LC_RC$pvalue)]
# select relevant sample columns for the given pairwise comparison
colnames(counts.transformed.vst)
counts_de <- counts.transformed.vst[,c(1,3,4,6,7,9,20,22,24,26,27,29,31,33,34)]
counts_de <- counts_de[rownames(counts.transformed.vst) %in% sigChanges,]
dim(counts_de)
# save plot
#pdf("Sid_Symbiont_C_PCA_LC_RC_subset.pdf")
pcadata = DESeq2::plotPCA(counts_de, intgroup = c("group"), returnData = TRUE)
percentVar = round(100 * attr(pcadata, "percentVar"))
pca = prcomp(t(assay(counts_de)), center = TRUE, scale. = FALSE)
plot <- DESeq2::plotPCA(counts_de, returnData = TRUE, intgroup = c("group")) %>%
ggplot(aes(x = PC1, y = PC2)) +
geom_point(aes(color = group), size = 1.3) +
stat_ellipse(geom = "polygon", alpha = 1/10, aes(fill = group)) +
scale_color_manual(values = c("dodgerblue", "gold2", "#163343", "firebrick", "forestgreen", "bisque3")) + #chosen.palette
scale_fill_manual(values = c("dodgerblue", "gold2", "#163343", "firebrick", "forestgreen", "bisque3")) +
xlab(paste0("PC1: ",percentVar[1],"% variance")) +
ylab(paste0("PC2: ",percentVar[2],"% variance")) +
labs(title = "Lagoon-Control vs. Reef-Control (4073 genes)") +
labs(color = "Origin.Destination", fill = "Origin.Destination") +
theme_cowplot()
plot
#dev.off()
# save plot
pdf("Sid_Symbiont_C_PCA_LC_RC_subset.pdf")
pcadata = DESeq2::plotPCA(counts_de, intgroup = c("group"), returnData = TRUE)
percentVar = round(100 * attr(pcadata, "percentVar"))
pca = prcomp(t(assay(counts_de)), center = TRUE, scale. = FALSE)
plot <- DESeq2::plotPCA(counts_de, returnData = TRUE, intgroup = c("group")) %>%
ggplot(aes(x = PC1, y = PC2)) +
geom_point(aes(color = group), size = 1.3) +
stat_ellipse(geom = "polygon", alpha = 1/10, aes(fill = group)) +
scale_color_manual(values = c("dodgerblue", "gold2", "#163343", "firebrick", "forestgreen", "bisque3")) + #chosen.palette
scale_fill_manual(values = c("dodgerblue", "gold2", "#163343", "firebrick", "forestgreen", "bisque3")) +
xlab(paste0("PC1: ",percentVar[1],"% variance")) +
ylab(paste0("PC2: ",percentVar[2],"% variance")) +
labs(title = "Lagoon-Control vs. Reef-Control (4073 genes)") +
labs(color = "Origin.Destination", fill = "Origin.Destination") +
theme_cowplot()
plot
dev.off()
# save plot
#pdf("Sid_Symbiont_C_PCA_LC_RC_subset.pdf")
pcadata = DESeq2::plotPCA(counts_de, intgroup = c("group"), returnData = TRUE)
percentVar = round(100 * attr(pcadata, "percentVar"))
pca = prcomp(t(assay(counts_de)), center = TRUE, scale. = FALSE)
plot <- DESeq2::plotPCA(counts_de, returnData = TRUE, intgroup = c("group")) %>%
ggplot(aes(x = PC1, y = PC2)) +
geom_point(aes(color = group), size = 1.3) +
stat_ellipse(geom = "polygon", alpha = 1/10, aes(fill = group)) +
scale_color_manual(values = c("dodgerblue", "gold2", "#163343", "firebrick", "forestgreen", "bisque3")) + #chosen.palette
scale_fill_manual(values = c("dodgerblue", "gold2", "#163343", "firebrick", "forestgreen", "bisque3")) +
xlab(paste0("PC1: ",percentVar[1],"% variance")) +
ylab(paste0("PC2: ",percentVar[2],"% variance")) +
labs(title = "Lagoon-Control vs. Reef-Control (4073 genes)") +
labs(color = "Origin.Destination", fill = "Origin.Destination") +
theme_cowplot()
plot
#dev.off()
dim(counts_de)
dim(de.genes.LC_RC)
colnames(counts_de)
# extract row names from DE gene list
rownames(de.genes.OC_RC) <- de.genes.OC_RC[,1]
sigChanges <- rownames(de.genes.OC_RC)[de.genes.OC_RC$pvalue < 0.05 & !is.na(de.genes.OC_RC$pvalue)]
counts_de <- counts.transformed.vst[rownames(counts.transformed.vst) %in% sigChanges,]
dim(counts_de)
pcadata = DESeq2::plotPCA(counts_de, intgroup = c("group"), returnData = TRUE)
percentVar = round(100 * attr(pcadata, "percentVar"))
pca = prcomp(t(assay(counts_de)), center = TRUE, scale. = FALSE)
plot <- DESeq2::plotPCA(counts_de, returnData = TRUE, intgroup = c("group")) %>%
ggplot(aes(x = PC1, y = PC2)) +
geom_point(aes(color = group), size = 1.3) +
stat_ellipse(geom = "polygon", alpha = 1/10, aes(fill = group)) +
scale_color_manual(values = c("dodgerblue", "gold2", "#163343", "firebrick", "forestgreen", "bisque3")) + #chosen.palette
scale_fill_manual(values = c("dodgerblue", "gold2", "#163343", "firebrick", "forestgreen", "bisque3")) +
xlab(paste0("PC1: ",percentVar[1],"% variance")) +
ylab(paste0("PC2: ",percentVar[2],"% variance")) +
labs(title = "Ojo-Control vs. Reef-Control (5516 genes)") +
labs(color = "Origin.Destination", fill = "Origin.Destination") +
theme_cowplot()
plot
# save plot
pdf("Sid_Symbiont_C_PCA_OC_RC_all-indiv.pdf")
pcadata = DESeq2::plotPCA(counts_de, intgroup = c("group"), returnData = TRUE)
percentVar = round(100 * attr(pcadata, "percentVar"))
pca = prcomp(t(assay(counts_de)), center = TRUE, scale. = FALSE)
plot <- DESeq2::plotPCA(counts_de, returnData = TRUE, intgroup = c("group")) %>%
ggplot(aes(x = PC1, y = PC2)) +
geom_point(aes(color = group), size = 1.3) +
stat_ellipse(geom = "polygon", alpha = 1/10, aes(fill = group)) +
scale_color_manual(values = c("dodgerblue", "gold2", "#163343", "firebrick", "forestgreen", "bisque3")) + #chosen.palette
scale_fill_manual(values = c("dodgerblue", "gold2", "#163343", "firebrick", "forestgreen", "bisque3")) +
xlab(paste0("PC1: ",percentVar[1],"% variance")) +
ylab(paste0("PC2: ",percentVar[2],"% variance")) +
labs(title = "Ojo-Control vs. Reef-Control (5516 genes)") +
labs(color = "Origin.Destination", fill = "Origin.Destination") +
theme_cowplot()
plot
dev.off()
rownames(de.genes.OC_RC) <- de.genes.OC_RC[,1]
sigChanges <- rownames(de.genes.OC_RC)[de.genes.OC_RC$pvalue < 0.05 & !is.na(de.genes.OC_RC$pvalue)]
# select relevant sample columns for the given pairwise comparison
colnames(counts.transformed.vst)
# extract row names from DE gene list
rownames(de.genes.OC_RC) <- de.genes.OC_RC[,1]
sigChanges <- rownames(de.genes.OC_RC)[de.genes.OC_RC$pvalue < 0.05 & !is.na(de.genes.OC_RC$pvalue)]
# select relevant sample columns for the given pairwise comparison
colnames(counts.transformed.vst)
counts_de <- counts.transformed.vst[,c(12,14,17,20,22,24,26,27,29,31,33,34)]
counts_de <- counts_de[rownames(counts.transformed.vst) %in% sigChanges,]
dim(counts_de)
# save plot
#pdf("Sid_Symbiont_C_PCA_OC_RC_subset.pdf")
pcadata = DESeq2::plotPCA(counts_de, intgroup = c("group"), returnData = TRUE)
percentVar = round(100 * attr(pcadata, "percentVar"))
pca = prcomp(t(assay(counts_de)), center = TRUE, scale. = FALSE)
plot <- DESeq2::plotPCA(counts_de, returnData = TRUE, intgroup = c("group")) %>%
ggplot(aes(x = PC1, y = PC2)) +
geom_point(aes(color = group), size = 1.3) +
stat_ellipse(geom = "polygon", alpha = 1/10, aes(fill = group)) +
scale_color_manual(values = c("dodgerblue", "gold2", "#163343", "firebrick", "forestgreen", "bisque3")) + #chosen.palette
scale_fill_manual(values = c("dodgerblue", "gold2", "#163343", "firebrick", "forestgreen", "bisque3")) +
xlab(paste0("PC1: ",percentVar[1],"% variance")) +
ylab(paste0("PC2: ",percentVar[2],"% variance")) +
labs(title = "Ojo-Control vs. Reef-Control (5516 genes)") +
labs(color = "Origin.Destination", fill = "Origin.Destination") +
theme_cowplot()
plot
#dev.off()
# save plot
pdf("Sid_Symbiont_C_PCA_OC_RC_subset.pdf")
pcadata = DESeq2::plotPCA(counts_de, intgroup = c("group"), returnData = TRUE)
percentVar = round(100 * attr(pcadata, "percentVar"))
pca = prcomp(t(assay(counts_de)), center = TRUE, scale. = FALSE)
plot <- DESeq2::plotPCA(counts_de, returnData = TRUE, intgroup = c("group")) %>%
ggplot(aes(x = PC1, y = PC2)) +
geom_point(aes(color = group), size = 1.3) +
stat_ellipse(geom = "polygon", alpha = 1/10, aes(fill = group)) +
scale_color_manual(values = c("dodgerblue", "gold2", "#163343", "firebrick", "forestgreen", "bisque3")) + #chosen.palette
scale_fill_manual(values = c("dodgerblue", "gold2", "#163343", "firebrick", "forestgreen", "bisque3")) +
xlab(paste0("PC1: ",percentVar[1],"% variance")) +
ylab(paste0("PC2: ",percentVar[2],"% variance")) +
labs(title = "Ojo-Control vs. Reef-Control (5516 genes)") +
labs(color = "Origin.Destination", fill = "Origin.Destination") +
theme_cowplot()
plot
dev.off()
# save plot
#pdf("Sid_Symbiont_C_PCA_OC_RC_subset.pdf")
pcadata = DESeq2::plotPCA(counts_de, intgroup = c("group"), returnData = TRUE)
percentVar = round(100 * attr(pcadata, "percentVar"))
pca = prcomp(t(assay(counts_de)), center = TRUE, scale. = FALSE)
plot <- DESeq2::plotPCA(counts_de, returnData = TRUE, intgroup = c("group")) %>%
ggplot(aes(x = PC1, y = PC2)) +
geom_point(aes(color = group), size = 1.3) +
stat_ellipse(geom = "polygon", alpha = 1/10, aes(fill = group)) +
scale_color_manual(values = c("dodgerblue", "gold2", "#163343", "firebrick", "forestgreen", "bisque3")) + #chosen.palette
scale_fill_manual(values = c("dodgerblue", "gold2", "#163343", "firebrick", "forestgreen", "bisque3")) +
xlab(paste0("PC1: ",percentVar[1],"% variance")) +
ylab(paste0("PC2: ",percentVar[2],"% variance")) +
labs(title = "Ojo-Control vs. Reef-Control (5516 genes)") +
labs(color = "Origin.Destination", fill = "Origin.Destination") +
theme_cowplot()
plot
#dev.off()
dim(counts_de)
dim(de.genes.OC_RC)
colnames(counts_de)
# extract row names from DE gene list
rownames(de.genes.RO_RC) <- de.genes.RO_RC[,1]
sigChanges <- rownames(de.genes.RO_RC)[de.genes.RO_RC$pvalue < 0.05 & !is.na(de.genes.RO_RC$pvalue)]
counts_de <- counts.transformed.vst[rownames(counts.transformed.vst) %in% sigChanges,]
dim(counts_de)
pcadata = DESeq2::plotPCA(counts_de, intgroup = c("group"), returnData = TRUE)
percentVar = round(100 * attr(pcadata, "percentVar"))
pca = prcomp(t(assay(counts_de)), center = TRUE, scale. = FALSE)
plot <- DESeq2::plotPCA(counts_de, returnData = TRUE, intgroup = c("group")) %>%
ggplot(aes(x = PC1, y = PC2)) +
geom_point(aes(color = group), size = 1.3) +
stat_ellipse(geom = "polygon", alpha = 1/10, aes(fill = group)) +
scale_color_manual(values = c("dodgerblue", "gold2", "#163343", "firebrick", "forestgreen", "bisque3")) + #chosen.palette
scale_fill_manual(values = c("dodgerblue", "gold2", "#163343", "firebrick", "forestgreen", "bisque3")) +
xlab(paste0("PC1: ",percentVar[1],"% variance")) +
ylab(paste0("PC2: ",percentVar[2],"% variance")) +
labs(title = "Reef-Ojo vs. Reef-Control (494 genes)") +
labs(color = "Origin.Destination", fill = "Origin.Destination") +
theme_cowplot()
plot
# save plot
pdf("Sid_Symbiont_C_PCA_RO_RC_all-indiv.pdf")
pcadata = DESeq2::plotPCA(counts_de, intgroup = c("group"), returnData = TRUE)
percentVar = round(100 * attr(pcadata, "percentVar"))
pca = prcomp(t(assay(counts_de)), center = TRUE, scale. = FALSE)
plot <- DESeq2::plotPCA(counts_de, returnData = TRUE, intgroup = c("group")) %>%
ggplot(aes(x = PC1, y = PC2)) +
geom_point(aes(color = group), size = 1.3) +
stat_ellipse(geom = "polygon", alpha = 1/10, aes(fill = group)) +
scale_color_manual(values = c("dodgerblue", "gold2", "#163343", "firebrick", "forestgreen", "bisque3")) + #chosen.palette
scale_fill_manual(values = c("dodgerblue", "gold2", "#163343", "firebrick", "forestgreen", "bisque3")) +
xlab(paste0("PC1: ",percentVar[1],"% variance")) +
ylab(paste0("PC2: ",percentVar[2],"% variance")) +
labs(title = "Reef-Ojo vs. Reef-Control (494 genes)") +
labs(color = "Origin.Destination", fill = "Origin.Destination") +
theme_cowplot()
plot
dev.off()
rownames(de.genes.RO_RC) <- de.genes.RO_RC[,1]
sigChanges <- rownames(de.genes.RO_RC)[de.genes.RO_RC$pvalue < 0.05 & !is.na(de.genes.RO_RC$pvalue)]
# select relevant sample columns for the given pairwise comparison
colnames(counts.transformed.vst)
# extract row names from DE gene list
rownames(de.genes.RO_RC) <- de.genes.RO_RC[,1]
sigChanges <- rownames(de.genes.RO_RC)[de.genes.RO_RC$pvalue < 0.05 & !is.na(de.genes.RO_RC$pvalue)]
# select relevant sample columns for the given pairwise comparison
colnames(counts.transformed.vst)
counts_de <- counts.transformed.vst[,c(20:35)]
counts_de <- counts_de[rownames(counts.transformed.vst) %in% sigChanges,]
dim(counts_de)
# save plot
#pdf("Sid_Symbiont_C_PCA_RO_RC_subset.pdf")
pcadata = DESeq2::plotPCA(counts_de, intgroup = c("group"), returnData = TRUE)
percentVar = round(100 * attr(pcadata, "percentVar"))
pca = prcomp(t(assay(counts_de)), center = TRUE, scale. = FALSE)
plot <- DESeq2::plotPCA(counts_de, returnData = TRUE, intgroup = c("group")) %>%
ggplot(aes(x = PC1, y = PC2)) +
geom_point(aes(color = group), size = 1.3) +
stat_ellipse(geom = "polygon", alpha = 1/10, aes(fill = group)) +
scale_color_manual(values = c("dodgerblue", "gold2", "#163343", "firebrick", "forestgreen", "bisque3")) + #chosen.palette
scale_fill_manual(values = c("dodgerblue", "gold2", "#163343", "firebrick", "forestgreen", "bisque3")) +
xlab(paste0("PC1: ",percentVar[1],"% variance")) +
ylab(paste0("PC2: ",percentVar[2],"% variance")) +
labs(title = "Reef-Ojo vs. Reef-Control (494 genes)") +
labs(color = "Origin.Destination", fill = "Origin.Destination") +
theme_cowplot()
plot
#dev.off()
# save plot
pdf("Sid_Symbiont_C_PCA_RO_RC_subset.pdf")
pcadata = DESeq2::plotPCA(counts_de, intgroup = c("group"), returnData = TRUE)
percentVar = round(100 * attr(pcadata, "percentVar"))
pca = prcomp(t(assay(counts_de)), center = TRUE, scale. = FALSE)
plot <- DESeq2::plotPCA(counts_de, returnData = TRUE, intgroup = c("group")) %>%
ggplot(aes(x = PC1, y = PC2)) +
geom_point(aes(color = group), size = 1.3) +
stat_ellipse(geom = "polygon", alpha = 1/10, aes(fill = group)) +
scale_color_manual(values = c("dodgerblue", "gold2", "#163343", "firebrick", "forestgreen", "bisque3")) + #chosen.palette
scale_fill_manual(values = c("dodgerblue", "gold2", "#163343", "firebrick", "forestgreen", "bisque3")) +
xlab(paste0("PC1: ",percentVar[1],"% variance")) +
ylab(paste0("PC2: ",percentVar[2],"% variance")) +
labs(title = "Reef-Ojo vs. Reef-Control (494 genes)") +
labs(color = "Origin.Destination", fill = "Origin.Destination") +
theme_cowplot()
plot
dev.off()
dim(counts_de)
dim(de.genes.RO_RC)
colnames(counts_de)
# extract row names from DE gene list
rownames(de.genes.OO_RO) <- de.genes.OO_RO[,1]
sigChanges <- rownames(de.genes.OO_RO)[de.genes.OO_RO$pvalue < 0.05 & !is.na(de.genes.OO_RO$pvalue)]
counts_de <- counts.transformed.vst[rownames(counts.transformed.vst) %in% sigChanges,]
dim(counts_de)
pcadata = DESeq2::plotPCA(counts_de, intgroup = c("group"), returnData = TRUE)
percentVar = round(100 * attr(pcadata, "percentVar"))
pca = prcomp(t(assay(counts_de)), center = TRUE, scale. = FALSE)
plot <- DESeq2::plotPCA(counts_de, returnData = TRUE, intgroup = c("group")) %>%
ggplot(aes(x = PC1, y = PC2)) +
geom_point(aes(color = group), size = 1.3) +
stat_ellipse(geom = "polygon", alpha = 1/10, aes(fill = group)) +
scale_color_manual(values = c("dodgerblue", "gold2", "#163343", "firebrick", "forestgreen", "bisque3")) + #chosen.palette
scale_fill_manual(values = c("dodgerblue", "gold2", "#163343", "firebrick", "forestgreen", "bisque3")) +
xlab(paste0("PC1: ",percentVar[1],"% variance")) +
ylab(paste0("PC2: ",percentVar[2],"% variance")) +
labs(title = "Ojo-Ojo vs. Reef-Ojo (3952 genes)") +
labs(color = "Origin.Destination", fill = "Origin.Destination") +
theme_cowplot()
plot
# save plot
pdf("Sid_Symbiont_C_PCA_OO_RO_all-indiv.pdf")
pcadata = DESeq2::plotPCA(counts_de, intgroup = c("group"), returnData = TRUE)
percentVar = round(100 * attr(pcadata, "percentVar"))
pca = prcomp(t(assay(counts_de)), center = TRUE, scale. = FALSE)
plot <- DESeq2::plotPCA(counts_de, returnData = TRUE, intgroup = c("group")) %>%
ggplot(aes(x = PC1, y = PC2)) +
geom_point(aes(color = group), size = 1.3) +
stat_ellipse(geom = "polygon", alpha = 1/10, aes(fill = group)) +
scale_color_manual(values = c("dodgerblue", "gold2", "#163343", "firebrick", "forestgreen", "bisque3")) + #chosen.palette
scale_fill_manual(values = c("dodgerblue", "gold2", "#163343", "firebrick", "forestgreen", "bisque3")) +
xlab(paste0("PC1: ",percentVar[1],"% variance")) +
ylab(paste0("PC2: ",percentVar[2],"% variance")) +
labs(title = "Ojo-Ojo vs. Reef-Ojo (3952 genes)") +
labs(color = "Origin.Destination", fill = "Origin.Destination") +
theme_cowplot()
plot
dev.off()
rownames(de.genes.OO_RO) <- de.genes.OO_RO[,1]
sigChanges <- rownames(de.genes.OO_RO)[de.genes.OO_RO$pvalue < 0.05 & !is.na(de.genes.OO_RO$pvalue)]
# select relevant sample columns for the given pairwise comparison
colnames(counts.transformed.vst)
# extract row names from DE gene list
rownames(de.genes.OO_RO) <- de.genes.OO_RO[,1]
sigChanges <- rownames(de.genes.OO_RO)[de.genes.OO_RO$pvalue < 0.05 & !is.na(de.genes.OO_RO$pvalue)]
# select relevant sample columns for the given pairwise comparison
colnames(counts.transformed.vst)
counts_de <- counts.transformed.vst[,c(11,13,15,16,18,19,21,23,25,28,30,32,35)]
counts_de <- counts_de[rownames(counts.transformed.vst) %in% sigChanges,]
dim(counts_de)
# save plot
#pdf("Sid_Symbiont_C_PCA_OO_RO_subset.pdf")
pcadata = DESeq2::plotPCA(counts_de, intgroup = c("group"), returnData = TRUE)
percentVar = round(100 * attr(pcadata, "percentVar"))
pca = prcomp(t(assay(counts_de)), center = TRUE, scale. = FALSE)
plot <- DESeq2::plotPCA(counts_de, returnData = TRUE, intgroup = c("group")) %>%
ggplot(aes(x = PC1, y = PC2)) +
geom_point(aes(color = group), size = 1.3) +
stat_ellipse(geom = "polygon", alpha = 1/10, aes(fill = group)) +
scale_color_manual(values = c("dodgerblue", "gold2", "#163343", "firebrick", "forestgreen", "bisque3")) + #chosen.palette
scale_fill_manual(values = c("dodgerblue", "gold2", "#163343", "firebrick", "forestgreen", "bisque3")) +
xlab(paste0("PC1: ",percentVar[1],"% variance")) +
ylab(paste0("PC2: ",percentVar[2],"% variance")) +
labs(title = "Ojo-Ojo vs. Reef-Ojo (3952 genes)") +
labs(color = "Origin.Destination", fill = "Origin.Destination") +
theme_cowplot()
plot
#dev.off()
dim(counts_de)
dim(de.genes.OO_RO)
colnames(counts_de)
# save plot
pdf("Sid_Symbiont_C_PCA_OO_RO_subset.pdf")
pcadata = DESeq2::plotPCA(counts_de, intgroup = c("group"), returnData = TRUE)
percentVar = round(100 * attr(pcadata, "percentVar"))
pca = prcomp(t(assay(counts_de)), center = TRUE, scale. = FALSE)
plot <- DESeq2::plotPCA(counts_de, returnData = TRUE, intgroup = c("group")) %>%
ggplot(aes(x = PC1, y = PC2)) +
geom_point(aes(color = group), size = 1.3) +
stat_ellipse(geom = "polygon", alpha = 1/10, aes(fill = group)) +
scale_color_manual(values = c("dodgerblue", "gold2", "#163343", "firebrick", "forestgreen", "bisque3")) + #chosen.palette
scale_fill_manual(values = c("dodgerblue", "gold2", "#163343", "firebrick", "forestgreen", "bisque3")) +
xlab(paste0("PC1: ",percentVar[1],"% variance")) +
ylab(paste0("PC2: ",percentVar[2],"% variance")) +
labs(title = "Ojo-Ojo vs. Reef-Ojo (3952 genes)") +
labs(color = "Origin.Destination", fill = "Origin.Destination") +
theme_cowplot()
plot
dev.off()
# extract row names from DE gene list
rownames(de.genes.LO_RO) <- de.genes.LO_RO[,1]
sigChanges <- rownames(de.genes.LO_RO)[de.genes.LO_RO$pvalue < 0.05 & !is.na(de.genes.LO_RO$pvalue)]
counts_de <- counts.transformed.vst[rownames(counts.transformed.vst) %in% sigChanges,]
dim(counts_de)
pcadata = DESeq2::plotPCA(counts_de, intgroup = c("group"), returnData = TRUE)
percentVar = round(100 * attr(pcadata, "percentVar"))
pca = prcomp(t(assay(counts_de)), center = TRUE, scale. = FALSE)
plot <- DESeq2::plotPCA(counts_de, returnData = TRUE, intgroup = c("group")) %>%
ggplot(aes(x = PC1, y = PC2)) +
geom_point(aes(color = group), size = 1.3) +
stat_ellipse(geom = "polygon", alpha = 1/10, aes(fill = group)) +
scale_color_manual(values = c("dodgerblue", "gold2", "#163343", "firebrick", "forestgreen", "bisque3")) + #chosen.palette
scale_fill_manual(values = c("dodgerblue", "gold2", "#163343", "firebrick", "forestgreen", "bisque3")) +
xlab(paste0("PC1: ",percentVar[1],"% variance")) +
ylab(paste0("PC2: ",percentVar[2],"% variance")) +
labs(title = "Lagoon-Ojo vs. Reef-Ojo (366 genes)") +
labs(color = "Origin.Destination", fill = "Origin.Destination") +
theme_cowplot()
plot
# save plot
pdf("Sid_Symbiont_C_PCA_LO_RO_all-indiv.pdf")
pcadata = DESeq2::plotPCA(counts_de, intgroup = c("group"), returnData = TRUE)
percentVar = round(100 * attr(pcadata, "percentVar"))
pca = prcomp(t(assay(counts_de)), center = TRUE, scale. = FALSE)
plot <- DESeq2::plotPCA(counts_de, returnData = TRUE, intgroup = c("group")) %>%
ggplot(aes(x = PC1, y = PC2)) +
geom_point(aes(color = group), size = 1.3) +
stat_ellipse(geom = "polygon", alpha = 1/10, aes(fill = group)) +
scale_color_manual(values = c("dodgerblue", "gold2", "#163343", "firebrick", "forestgreen", "bisque3")) + #chosen.palette
scale_fill_manual(values = c("dodgerblue", "gold2", "#163343", "firebrick", "forestgreen", "bisque3")) +
xlab(paste0("PC1: ",percentVar[1],"% variance")) +
ylab(paste0("PC2: ",percentVar[2],"% variance")) +
labs(title = "Lagoon-Ojo vs. Reef-Ojo (366 genes)") +
labs(color = "Origin.Destination", fill = "Origin.Destination") +
theme_cowplot()
plot
dev.off()
rownames(de.genes.LO_RO) <- de.genes.LO_RO[,1]
sigChanges <- rownames(de.genes.LO_RO)[de.genes.LO_RO$pvalue < 0.05 & !is.na(de.genes.LO_RO$pvalue)]
# select relevant sample columns for the given pairwise comparison
colnames(counts.transformed.vst)
# extract row names from DE gene list
rownames(de.genes.LO_RO) <- de.genes.LO_RO[,1]
sigChanges <- rownames(de.genes.LO_RO)[de.genes.LO_RO$pvalue < 0.05 & !is.na(de.genes.LO_RO$pvalue)]
# select relevant sample columns for the given pairwise comparison
colnames(counts.transformed.vst)
counts_de <- counts.transformed.vst[,c(2,5,7,8,10,21,23,25,28,30,32,35)]
counts_de <- counts_de[rownames(counts.transformed.vst) %in% sigChanges,]
dim(counts_de)
# extract row names from DE gene list
rownames(de.genes.LO_RO) <- de.genes.LO_RO[,1]
sigChanges <- rownames(de.genes.LO_RO)[de.genes.LO_RO$pvalue < 0.05 & !is.na(de.genes.LO_RO$pvalue)]
# select relevant sample columns for the given pairwise comparison
colnames(counts.transformed.vst)
counts_de <- counts.transformed.vst[,c(2,5,8,10,21,23,25,28,30,32,35)]
counts_de <- counts_de[rownames(counts.transformed.vst) %in% sigChanges,]
dim(counts_de)
# extract row names from DE gene list
rownames(de.genes.LO_RO) <- de.genes.LO_RO[,1]
sigChanges <- rownames(de.genes.LO_RO)[de.genes.LO_RO$pvalue < 0.05 & !is.na(de.genes.LO_RO$pvalue)]
# select relevant sample columns for the given pairwise comparison
colnames(counts.transformed.vst)
counts_de <- counts.transformed.vst[,c(2,5,8,10,21,23,25,28,30,32,35)]
counts_de <- counts_de[rownames(counts.transformed.vst) %in% sigChanges,]
dim(counts_de)
# save plot
#pdf("Sid_Symbiont_C_PCA_LO_RO_subset.pdf")
pcadata = DESeq2::plotPCA(counts_de, intgroup = c("group"), returnData = TRUE)
percentVar = round(100 * attr(pcadata, "percentVar"))
pca = prcomp(t(assay(counts_de)), center = TRUE, scale. = FALSE)
plot <- DESeq2::plotPCA(counts_de, returnData = TRUE, intgroup = c("group")) %>%
ggplot(aes(x = PC1, y = PC2)) +
geom_point(aes(color = group), size = 1.3) +
stat_ellipse(geom = "polygon", alpha = 1/10, aes(fill = group)) +
scale_color_manual(values = c("dodgerblue", "gold2", "#163343", "firebrick", "forestgreen", "bisque3")) + #chosen.palette
scale_fill_manual(values = c("dodgerblue", "gold2", "#163343", "firebrick", "forestgreen", "bisque3")) +
xlab(paste0("PC1: ",percentVar[1],"% variance")) +
ylab(paste0("PC2: ",percentVar[2],"% variance")) +
labs(title = "Lagoon-Ojo vs. Reef-Ojo (366 genes)") +
labs(color = "Origin.Destination", fill = "Origin.Destination") +
theme_cowplot()
plot
#dev.off()
dim(counts_de)
dim(de.genes.LO_RO)
colnames(counts_de)
# save plot
pdf("Sid_Symbiont_C_PCA_LO_RO_subset.pdf")
pcadata = DESeq2::plotPCA(counts_de, intgroup = c("group"), returnData = TRUE)
percentVar = round(100 * attr(pcadata, "percentVar"))
pca = prcomp(t(assay(counts_de)), center = TRUE, scale. = FALSE)
plot <- DESeq2::plotPCA(counts_de, returnData = TRUE, intgroup = c("group")) %>%
ggplot(aes(x = PC1, y = PC2)) +
geom_point(aes(color = group), size = 1.3) +
stat_ellipse(geom = "polygon", alpha = 1/10, aes(fill = group)) +
scale_color_manual(values = c("dodgerblue", "gold2", "#163343", "firebrick", "forestgreen", "bisque3")) + #chosen.palette
scale_fill_manual(values = c("dodgerblue", "gold2", "#163343", "firebrick", "forestgreen", "bisque3")) +
xlab(paste0("PC1: ",percentVar[1],"% variance")) +
ylab(paste0("PC2: ",percentVar[2],"% variance")) +
labs(title = "Lagoon-Ojo vs. Reef-Ojo (366 genes)") +
labs(color = "Origin.Destination", fill = "Origin.Destination") +
theme_cowplot()
plot
dev.off()
rm(list=ls())
