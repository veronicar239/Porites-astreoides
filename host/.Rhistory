# input: numeric vector of p-values
moduleTraitPadj = p.adjust(moduleTraitPvalue, method="BH")
# correlations of genes with eigengenes
moduleGeneCor=cor(MEs,dat)
moduleGenePvalue = corPvalueStudent(moduleGeneCor, nSamples)
library(RColorBrewer)
modLabels=sub("ME","",names(MEs))
ps=signif(moduleTraitPadj,1)
cors=signif(moduleTraitCor,2)
textMatrix = cors;
#paste(cors, "\n(",ps, ")", sep = "");
textMatrix[ps>0.05]="-"
dim(textMatrix) = dim(moduleTraitCor)
par(mar = c(6, 8.5, 3, 3));
# Display the correlation values within a heatmap plot
labeledHeatmap(Matrix = moduleTraitCor,
xLabels = names(traits),
ySymbols = modLabels,
yLabels = modLabels,
colorLabels = FALSE,
colors = colorRampPalette(c("blue","lightblue","white","coral","red"))(50),
textMatrix = textMatrix,
setStdMargins = FALSE,
cex.text = 0.7,
zlim = c(-0.7,0.7),
main = paste("Siderastrea Host Module-Trait correlations"))
modNames = substring(names(MEs), 3)
module = "MEcyan"
column = match(module, modNames);
moduleGenes = moduleColors==module;
modNames = substring(names(MEs), 3)
module = "MEcyan"
column = match(module, modNames);
moduleGenes = moduleColors_merged==module;
sizeGrWindow(7, 7);
par(mfrow = c(1,1));
verboseScatterplot(abs(geneModuleMembership[moduleGenes, column]),
abs(geneTraitSignificance[moduleGenes, 1]),
xlab = paste("Module Membership in", module, "module"),
ylab = "Gene significance for pCO2 (uatm)",
main = paste("Module membership vs. gene significance\n"),
cex.main = 1.2, cex.lab = 1.2, cex.axis = 1.2, col = module)
?GOenrichmentAnalysis
?enrichmentAnalysis
moduleTraitPadj = p.adjust(moduleTraitPvalue, method="fdr")
library(RColorBrewer)
modLabels=sub("ME","",names(MEs))
ps=signif(moduleTraitPadj,1)
cors=signif(moduleTraitCor,2)
textMatrix = cors;
#paste(cors, "\n(",ps, ")", sep = "");
textMatrix[ps>0.05]="-"
dim(textMatrix) = dim(moduleTraitCor)
par(mar = c(6, 8.5, 3, 3));
# Display the correlation values within a heatmap plot
labeledHeatmap(Matrix = moduleTraitCor,
xLabels = names(traits),
ySymbols = modLabels,
yLabels = modLabels,
colorLabels = FALSE,
colors = colorRampPalette(c("blue","lightblue","white","coral","red"))(50),
textMatrix = textMatrix,
setStdMargins = FALSE,
cex.text = 0.7,
zlim = c(-0.7,0.7),
main = paste("Siderastrea Host Module-Trait correlations"))
rm(list=ls())
library(RColorBrewer)
library(circlize)
library(pheatmap)
library(gplots) #heatmap.2()
library(ComplexHeatmap)
library(tidyverse)
library(vegan)
library(cowplot)
library(ggrepel)
library(devtools)
library(vsn)
library(dplyr)
library(plyr)
library(ggplot2)
library(knitr)
library(gridExtra)
library(data.table)
# first time installation:
# if (!requireNamespace("BiocManager", quietly = TRUE))
#     install.packages("BiocManager")
# BiocManager::install("DESeq2")
# BiocManager::install("DEGreport")
# BiocManager::install("arrayQualityMetrics")
library(BiocManager)
library(DESeq2)
library(DEGreport)
library(arrayQualityMetrics)
library(locfit)
setwd("~/Documents/Rprojects/postdoc\ Rprojects/ODU_postdoc_Rprojects/Paper_Ojo_gene-expression/Porites_astreoides/host/")
host <- read.csv("Genes_Past_OA_ojo.csv", header=TRUE, row.names=1)
dim(host)
## Some genes were not detected in all samples (genes with zero reads), n = 221 genes
host <- host[rowSums(host) > 0, ]
dim(host)
meta <- read.csv("~/Documents/Rprojects/postdoc\ Rprojects/ODU_postdoc_Rprojects/Paper_Ojo_gene-expression/Porites_astreoides/P_astreoides_Year-2_metadata.csv", header=TRUE, row.names=1)
# Remove all samples that were transplanted to the Destination Ojo.Norte
# There is no control site for Norte Ojo
# For now, we are focused on samples transplanted to Laja Control or Laja Ojo sites
# This is consistent with analyses for the other 2 species in the experiment
# Also, group sample size is too small for Ojo.Norte destination
meta <- subset(meta, Destination_name != "Ojo.Norte")
meta$Destination_type <- revalue(meta$Destination_type, c("control" = "Control", "ojo" = "Ojo"))
meta$Origin_type <- revalue(meta$Origin_type, c("Control" = "Lagoon"))
meta <- meta %>% unite(group, Origin_type, Destination_type, sep = ".", remove = FALSE)
meta[sapply(meta, is.character)] <- lapply(meta[sapply(meta, is.character)],
as.factor)
# Colony_ID is equivalent to genotype
meta$Colony_ID <- as.factor(meta$Colony_ID)
levels(meta$group)
meta <- dplyr::select(meta, Colony_ID, group, Origin_name, Origin_type, Destination_name, Destination_type, pH_Destination)
## The do.call() function produces a data frame with one col per sample,
## transpose it to obtain one row per sample and one column per statistics.
stats.per.sample <- data.frame(t(do.call(cbind, lapply(host, summary))))
stats.per.sample$libsum <- apply(host, 2, sum) ## libsum
stats.per.sample$zeros <- apply(host==0, 2, sum)
stats.per.sample$percent.zeros <- 100*stats.per.sample$zeros/nrow(host)
head(stats.per.sample)
meta <- read.csv("~/Documents/Rprojects/postdoc\ Rprojects/ODU_postdoc_Rprojects/Paper_Ojo_gene-expression/Porites_astreoides/P_astreoides_Year-2_metadata.csv", header=TRUE, row.names=1)
# Remove all samples that were transplanted to the Destination Ojo.Norte
# There is no control site for Norte Ojo
# For now, we are focused on samples transplanted to Laja Control or Laja Ojo sites
# This is consistent with analyses for the other 2 species in the experiment
# Also, group sample size is too small for Ojo.Norte destination
meta <- subset(meta, Destination_name != "Ojo.Norte")
View(meta)
meta$Origin_type <- revalue(meta$Origin_type, c("control" = "Control", "ojo" = "Ojo"))
meta$Destination_type <- revalue(meta$Destination_type, c("control" = "Control", "ojo" = "Ojo"))
meta$Origin_type <- revalue(meta$Origin_type, c("Control" = "Lagoon"))
meta <- meta %>% unite(group, Origin_type, Destination_type, sep = ".", remove = FALSE)
meta[sapply(meta, is.character)] <- lapply(meta[sapply(meta, is.character)],
as.factor)
# Colony_ID is equivalent to genotype
meta$Colony_ID <- as.factor(meta$Colony_ID)
levels(meta$group)
meta <- dplyr::select(meta, Colony_ID, group, Origin_name, Origin_type, Destination_name, Destination_type, pH_Destination)
## The do.call() function produces a data frame with one col per sample,
## transpose it to obtain one row per sample and one column per statistics.
stats.per.sample <- data.frame(t(do.call(cbind, lapply(host, summary))))
stats.per.sample$libsum <- apply(host, 2, sum) ## libsum
stats.per.sample$zeros <- apply(host==0, 2, sum)
stats.per.sample$percent.zeros <- 100*stats.per.sample$zeros/nrow(host)
head(stats.per.sample)
par(mfrow=c(3,1))
hist(as.matrix(host), col="blue", border="white", breaks=50)
hist(as.matrix(host), col="blue", border="white",
breaks=20000, xlim=c(0,500), main="Counts per gene",
xlab="Counts (truncated axis)", ylab="Number of genes",
las=1, cex.axis=0.7)
epsilon <- 1 # pseudo-count to avoid problems with log(0)
hist(as.matrix(log2(host + epsilon)), breaks=100, col="blue", border="white",
main="Log2-transformed counts per gene", xlab="log2(counts+1)", ylab="Number of genes",
las=1, cex.axis=0.7)
boxplot(log2(host + epsilon), col=meta$group, pch=".",
horizontal=TRUE, cex.axis=0.5, las=1,
xlab="log2(Counts +1)")
if(!require("affy")){
source("http://bioconductor.org/biocLite.R")
biocLite("affy")
}
library(affy)
## Each curve corresponds to one sample
plotDensity(log2(host + epsilon), lty=1, col= meta$group, lwd=2)
grid()
# how many genes have mean count >=3
host_means_filtered <- cbind(host, means = apply(host, 1, mean))
table(host_means_filtered$means>=3)
host_means_filtered <- subset(host_means_filtered, host_means_filtered$means>=3)
host_means_filtered <- host_means_filtered[, 1:56]
# how many genes have mean count >=3
host_means_filtered <- cbind(host, means = apply(host, 1, mean))
table(host_means_filtered$means>=3)
host_means_filtered <- subset(host_means_filtered, host_means_filtered$means>=3)
host_means_filtered <- host_means_filtered[, 1:40]
dim(host_means_filtered)
boxplot(log2(host_means_filtered + epsilon), col=meta$group, pch=".",
horizontal=TRUE, cex.axis=0.5, las=1,
xlab="log2(Counts +1)")
prop.null <- apply(host_means_filtered, 2, function(x) 100*mean(x==0))
barplot(prop.null, main="Percentage of null counts per sample",
horiz=TRUE, cex.names=0.5, las=1,
col=meta$group, ylab='Samples', xlab='% of null counts')
prop.null[order(prop.null)]
drop <- c("NC_318_N_Pa_yr2", "NO_278_N_Pa_yr2", "NO_266_N_Pa_yr2", "NC_327_N_Pa_yr2", "NO_275_N_Pa_yr2", "NC_293_N_Pa_yr2", "NO_272_N_Pa_yr2", "NC_312_N_Pa_yr2")
host_means_filtered <- host_means_filtered[,!(names(host_means_filtered) %in% drop)]
meta <- meta[!(row.names(meta) %in% drop),]
host_means_filtered <- droplevels(host_means_filtered)
meta <- droplevels(meta)
prop.null <- apply(host_means_filtered, 2, function(x) 100*mean(x==0))
barplot(prop.null, main="Percentage of null counts per sample",
horiz=TRUE, cex.names=0.5, las=1,
col=meta$group, ylab='Samples', xlab='% of null counts')
prop.null[order(prop.null)]
drop <- c("NC_292_La_Pa_yr2", "NC_320_La_Pa_yr2", "NC_311_La_Pa_yr2")
host_means_filtered <- host_means_filtered[,!(names(host_means_filtered) %in% drop)]
meta <- meta[!(row.names(meta) %in% drop),]
prop.null <- apply(host_means_filtered, 2, function(x) 100*mean(x==0))
prop.null[order(prop.null)]
prop.null <- apply(host_means_filtered, 2, function(x) 100*mean(x==0))
barplot(prop.null, main="Percentage of null counts per sample",
horiz=TRUE, cex.names=0.5, las=1,
col=meta$group, ylab='Samples', xlab='% of null counts')
meta %>%
group_by(group) %>%
dplyr::summarise(count = n())
# To get an idea about how RNA-seq counts are distributed, plot counts for a couple samples
p1 <- ggplot(host_means_filtered) +
geom_histogram(aes(x = NC_291_C_Pa_yr2), stat = "bin", bins = 200) +
xlim(-5, 500)  +
xlab("Raw expression counts") +
ylab("Number of genes")
p2 <- ggplot(host_means_filtered) +
geom_histogram(aes(x = NO_289_La_Pa_yr2), stat = "bin", bins = 200) +
xlim(-5, 500)  +
xlab("Raw expression counts") +
ylab("Number of genes")
grid.arrange(p1, p2, ncol = 2)
mean_counts <- apply(host_means_filtered, 1, mean)
variance_counts <- apply(host_means_filtered, 1, var)
df <- data.frame(mean_counts, variance_counts)
ggplot(df) +
geom_point(aes(x=mean_counts, y=variance_counts)) +
geom_line(aes(x=mean_counts, y=mean_counts, color="red")) +
scale_y_log10() +
scale_x_log10() +
theme(legend.position = "none")
# Check that sample names match in both files
all(colnames(host_means_filtered) %in% rownames(meta))
all(colnames(host_means_filtered) == rownames(meta))
# If your data did not match, you could use the match() function to rearrange them to be matching.
levels(meta$group)
# can only do 2 group comparisons (limitation of DESeq2)
dds <- DESeqDataSetFromMatrix(countData = host_means_filtered,
colData = meta,
design= ~group)
vsdBlindTrue <- DESeq2::varianceStabilizingTransformation(dds, blind = TRUE, fitType = "parametric")
boxplot(assay(vsdBlindTrue), col=meta$group)
vsdBlindFalse <- DESeq2::varianceStabilizingTransformation(dds, blind = FALSE, fitType = "parametric")
boxplot(assay(vsdBlindFalse), col=meta$group)
rlogged.BlindTrue = rlogTransformation(dds, blind = TRUE)
boxplot(assay(rlogged.BlindTrue), col=meta$group)
rlogged.BlindFalse = rlogTransformation(dds, blind = FALSE)
boxplot(assay(rlogged.BlindFalse), col=meta$group)
# this gives log2(n + 1)
ntd <- normTransform(dds)
meanSdPlot(assay(ntd))
meanSdPlot(assay(vsdBlindTrue))
meanSdPlot(assay(vsdBlindFalse))
meanSdPlot(assay(rlogged.BlindTrue))
meanSdPlot(assay(rlogged.BlindFalse))
dists.rlog.BlindFalse <- dist(t(assay(rlogged.BlindFalse)))
plot(hclust(dists.rlog.BlindFalse))
dists.vsdBlindFalse <- dist(t(assay(vsdBlindFalse)))
plot(hclust(dists.vsdBlindFalse))
# save varianceStabilizingTransformation counts
saveRDS(vsdBlindFalse, file = "counts_vst.BlindFalse_Past_Host.rds")
# later, after you already created the file, can load the existing file:
#vsdBlindFalse <- readRDS("counts_vst.BlindFalse_Past_Host.rds")
dds <- estimateSizeFactors(dds)
plot(sort(sizeFactors(dds)))
#sort.list(sizeFactors(dds))
sizeFactors(dds)
order(sizeFactors(dds), decreasing = TRUE)
# to retrieve the normalized counts matrix from dds
normalized_counts <- counts(dds, normalized=TRUE)
rownames(normalized_counts) <- rownames(host_means_filtered)
# Save normalized counts table as R data file for later use
saveRDS(normalized_counts, file = "counts_normalized_Past_Host.rds")
normalized_counts <- as.data.frame.array(normalized_counts)
setDT(normalized_counts, keep.rownames = "gene")
# Save normalized data matrix for later use:
write.csv(normalized_counts, "counts_normalized_Past_Host.csv", row.names = F)
colSums(counts(dds))[order(colSums(counts(dds)))]
colSums(counts(dds)) %>% barplot(col=meta$group)
# How do the numbers correlate with the size factor?
# Now take a look at the total depth after normalization using:
#colSums(counts(dds, normalized=T))
colSums(counts(dds, normalized=T))[order(colSums(counts(dds, normalized=T)))]
colSums(counts(dds, normalized = T)) %>% barplot(col=meta$group)
pcadata = DESeq2::plotPCA(vsdBlindFalse, intgroup = c( "group"), returnData = TRUE)
percentVar = round(100 * attr(pcadata, "percentVar"))
pca = prcomp(t(assay(vsdBlindFalse)), center = TRUE, scale. = FALSE)
DESeq2::plotPCA(vsdBlindFalse, returnData = TRUE, intgroup = c("group")) %>%
ggplot(aes(x = PC1, y = PC2)) +
geom_point(aes(colour = group), size = 2) +
stat_ellipse(geom = "polygon", alpha = 1/10, aes(fill = group)) +
xlab(paste0("PC1: ",percentVar[1],"% variance")) +
ylab(paste0("PC2: ",percentVar[2],"% variance")) +
theme_cowplot()
pcadata = DESeq2::plotPCA(vsdBlindFalse, intgroup = c("Origin_name"), returnData = TRUE)
percentVar = round(100 * attr(pcadata, "percentVar"))
pca = prcomp(t(assay(vsdBlindFalse)), center = TRUE, scale. = FALSE)
DESeq2::plotPCA(vsdBlindFalse, returnData = TRUE, intgroup = c("Origin_name") ) %>%
ggplot(aes(x = PC1, y = PC2)) +
geom_point(aes(colour = Origin_name), size = 2) +
stat_ellipse(geom = "polygon", alpha = 1/10, aes(fill = Origin_name)) +
xlab(paste0("PC1: ",percentVar[1],"% variance")) +
ylab(paste0("PC2: ",percentVar[2],"% variance")) +
theme_cowplot()
pcadata = DESeq2::plotPCA(vsdBlindFalse, intgroup = c("Destination_name"), returnData = TRUE)
percentVar = round(100 * attr(pcadata, "percentVar"))
pca = prcomp(t(assay(vsdBlindFalse)), center = TRUE, scale. = FALSE)
DESeq2::plotPCA(vsdBlindFalse, returnData = TRUE, intgroup = c("Destination_name") ) %>%
ggplot(aes(x = PC1, y = PC2)) +
geom_point(aes(colour = Destination_name), size = 2) +
stat_ellipse(geom = "polygon", alpha = 1/10, aes(fill = Destination_name)) +
xlab(paste0("PC1: ",percentVar[1],"% variance")) +
ylab(paste0("PC2: ",percentVar[2],"% variance")) +
theme_cowplot()
pcadata = DESeq2::plotPCA(vsdBlindFalse, intgroup = c("Colony_ID"), returnData = TRUE)
percentVar = round(100 * attr(pcadata, "percentVar"))
pca = prcomp(t(assay(vsdBlindFalse)), center = TRUE, scale. = FALSE)
DESeq2::plotPCA(vsdBlindFalse, returnData = TRUE, intgroup = c("Colony_ID")) %>%
ggplot(aes(x = PC1, y = PC2)) +
geom_point(aes(colour = Colony_ID), size = 2) +
xlab(paste0("PC1: ",percentVar[1],"% variance")) +
ylab(paste0("PC2: ",percentVar[2],"% variance")) +
theme_cowplot()
rld_mat <- assay(vsdBlindFalse)
rld_cor <- cor(rld_mat)
#head(rld_cor)   ## check the output of cor(), make note of the rownames and colnames
pheatmap(rld_cor)
# sample by distance heatmap
sampleDists <- as.matrix(dist(t(assay(vsdBlindFalse))))
heatmap.2(as.matrix(sampleDists), key=F, trace="none",
col=colorpanel(100, "black", "white"),
margin=c(10, 10))
# Generate normalized counts
# perform the median of ratios method of normalization
# perform a Wald test in DESeq2 pairwise comparison between treatment effects
dds <- DESeq2::DESeq(dds, fitType = "parametric", test = "Wald")
# copy here text from below:
# -- replacing outliers and refitting for 31 genes
# -- DESeq argument 'minReplicatesForReplace' = 7
# -- original counts are preserved in counts(dds)
results.dds = results(dds)
head(results.dds)
dispersionFunction(dds)
# already accomplished as part of DESeq() function (above):
#dds <- DESeq2::estimateSizeFactors(dds)
#dds <- DESeq2::estimateDispersionsGeneEst(dds)
#dds <- DESeq2::estimateDispersionsFit(dds)
#dds <- DESeq2::estimateDispersionsMAP(dds)
DESeq2::plotDispEsts(dds)
head(dispersions(dds))  # parametric
rownames(mcols(mcols(dds)))
rownames(mcols(dds))
rownames(mcols(mcols(dds)))
dispersions(dds) %>% hist(breaks = 500)
# It can be useful to include the sample names in the data set object:
rownames(dds) <- rownames(host_means_filtered)
levels(dds$group)
results_LO_LC_.1 <- results(dds, contrast = c("group", "Lagoon.Ojo", "Lagoon.Control"), alpha = 0.1)
head(results_LO_LC_.1)
summary(results_LO_LC_.1)
results_LO_LC_.1 <- results(dds, contrast = c("group", "Lagoon.Ojo", "Lagoon.Control"), alpha = 0.1)
head(results_LO_LC_.1)
summary(results_LO_LC_.1)
# convert to dataframe (from DESeq2 object)
res_LO_LC_.1_df <- data.frame(results_LO_LC_.1)
DE_LO_LC_padj.1 <- res_LO_LC_.1_df %>%
rownames_to_column('gene') %>%
as_tibble() %>%
filter(padj < 0.1) %>%
arrange(padj)
head(DE_LO_LC_padj.1)
# save rlogged file
saveRDS(DE_LO_LC_padj.1, file = "Past_Host_DE_genes_LO_LC_padj.1.rds")
write.csv(DE_LO_LC_padj.1, "Past_Host_DE_genes_LO_LC_padj.1.csv")
up.results_LO_LC_padj.1 = row.names(results_LO_LC_.1[results_LO_LC_.1$padj<0.1 & !(is.na(results_LO_LC_.1$padj)) & results_LO_LC_.1$log2FoldChange>0,])
up.results_LO_LC_padj.1 <- as.data.frame(up.results_LO_LC_padj.1)
up.results_LO_LC_padj.1$DEG <- 'Up'
down.results_LO_LC_padj.1 = row.names(results_LO_LC_.1[results_LO_LC_.1$padj<0.1 & !(is.na(results_LO_LC_.1$padj)) & results_LO_LC_.1$log2FoldChange<0,])
down.results_LO_LC_padj.1 <- as.data.frame(down.results_LO_LC_padj.1)
down.results_LO_LC_padj.1$DEG <- 'Down'
LO_LC_padj.1_summary <- merge(up.results_LO_LC_padj.1, down.results_LO_LC_padj.1, all=T)
dim(LO_LC_padj.1_summary)
# save file
write.csv(LO_LC_padj.1_summary, file="Past_Host_DE_genes_LO_LC_padj.1_summary.csv")
DE_LO_LC_pvalue <- res_LO_LC_.1_df %>%
rownames_to_column('gene') %>%
as_tibble() %>%
filter(pvalue < 0.05) %>%
arrange(pvalue)
head(DE_LO_LC_pvalue)
# save rlogged and csv files
saveRDS(DE_LO_LC_pvalue, file = "Past_Host_LO_LC_pval.05.rds")
write.csv(DE_LO_LC_pvalue, "Past_Host_LO_LC_pval.05.csv")
dim(DE_LO_LC_pvalue)
results_OO_LO_.1 <- results(dds, contrast = c("group", "Ojo.Ojo", "Lagoon.Ojo"), alpha = 0.1)
head(results_OO_LO_.1)
summary(results_OO_LO_.1)
# convert to dataframe (from DESeq2 object)
res_OO_LO_.1_df <- data.frame(results_OO_LO_.1)
DE_OO_LO_padj.1 <- res_OO_LO_.1_df %>%
rownames_to_column('gene') %>%
as_tibble() %>%
filter(padj < 0.1) %>%
arrange(padj)
head(DE_OO_LO_padj.1)
# save rlogged file
saveRDS(DE_OO_LO_padj.1, file = "Past_Host_DE_genes_OO_LO_padj.1.rds")
write.csv(DE_OO_LO_padj.1, "Past_Host_DE_genes_OO_LO_padj.1.csv")
up.results_OO_LO_padj.1 = row.names(results_OO_LO_.1[results_OO_LO_.1$padj<0.1 & !(is.na(results_OO_LO_.1$padj)) & results_OO_LO_.1$log2FoldChange>0,])
up.results_OO_LO_padj.1 <- as.data.frame(up.results_OO_LO_padj.1)
up.results_OO_LO_padj.1$DEG <- 'Up'
down.results_OO_LO_padj.1 = row.names(results_OO_LO_.1[results_OO_LO_.1$padj<0.1 & !(is.na(results_OO_LO_.1$padj)) & results_OO_LO_.1$log2FoldChange<0,])
down.results_OO_LO_padj.1 <- as.data.frame(down.results_OO_LO_padj.1)
down.results_OO_LO_padj.1$DEG <- 'Down'
OO_LO_padj.1_summary <- merge(up.results_OO_LO_padj.1, down.results_OO_LO_padj.1, all=T)
dim(OO_LO_padj.1_summary)
# save file
write.csv(OO_LO_padj.1_summary, file="Past_Host_DE_genes_OO_LO_padj.1_summary.csv")
DE_OO_LO_pvalue <- res_OO_LO_.1_df %>%
rownames_to_column('gene') %>%
as_tibble() %>%
filter(pvalue < 0.05) %>%
arrange(pvalue)
head(DE_OO_LO_pvalue)
# save rlogged and csv files
saveRDS(DE_OO_LO_pvalue, file = "Past_Host_OO_LO_pval.05.rds")
write.csv(DE_OO_LO_pvalue, "Past_Host_OO_LO_pval.05.csv")
dim(DE_OO_LO_pvalue)
results_OO_OC_.1 <- results(dds, contrast = c("group", "Ojo.Ojo", "Ojo.Control"), alpha = 0.1)
head(results_OO_OC_.1)
summary(results_OO_OC_.1)
# convert to dataframe (from DESeq2 object)
res_OO_OC_.1_df <- data.frame(results_OO_OC_.1)
DE_OO_OC_padj.1 <- res_OO_OC_.1_df %>%
rownames_to_column('gene') %>%
as_tibble() %>%
filter(padj < 0.1) %>%
arrange(padj)
head(DE_OO_OC_padj.1)
# save rlogged file
saveRDS(DE_OO_OC_padj.1, file = "Past_Host_DE_genes_OO_OC_padj.1.rds")
write.csv(DE_OO_OC_padj.1, "Past_Host_DE_genes_OO_OC_padj.1.csv")
up.results_OO_OC_padj.1 = row.names(results_OO_OC_.1[results_OO_OC_.1$padj<0.1 & !(is.na(results_OO_OC_.1$padj)) & results_OO_OC_.1$log2FoldChange>0,])
up.results_OO_OC_padj.1 <- as.data.frame(up.results_OO_OC_padj.1)
up.results_OO_OC_padj.1$DEG <- 'Up'
down.results_OO_OC_padj.1 = row.names(results_OO_OC_.1[results_OO_OC_.1$padj<0.1 & !(is.na(results_OO_OC_.1$padj)) & results_OO_OC_.1$log2FoldChange<0,])
down.results_OO_OC_padj.1 <- as.data.frame(down.results_OO_OC_padj.1)
down.results_OO_OC_padj.1$DEG <- 'Down'
OO_OC_padj.1_summary <- merge(up.results_OO_OC_padj.1, down.results_OO_OC_padj.1, all=T)
dim(OO_OC_padj.1_summary)
# save file
write.csv(OO_OC_padj.1_summary, file="Past_Host_DE_genes_OO_OC_padj.1_summary.csv")
DE_OO_OC_pvalue <- res_OO_OC_.1_df %>%
rownames_to_column('gene') %>%
as_tibble() %>%
filter(pvalue < 0.05) %>%
arrange(pvalue)
head(DE_OO_OC_pvalue)
# save rlogged and csv files
saveRDS(DE_OO_OC_pvalue, file = "Past_Host_OO_OC_pval.05.rds")
write.csv(DE_OO_OC_pvalue, "Past_Host_OO_OC_pval.05.csv")
dim(DE_OO_OC_pvalue)
results_OC_LC_.1 <- results(dds, contrast = c("group", "Ojo.Control", "Lagoon.Control"), alpha = 0.1)
head(results_OC_LC_.1)
summary(results_OC_LC_.1)
# convert to dataframe (from DESeq2 object)
res_OC_LC_.1_df <- data.frame(results_OC_LC_.1)
DE_OC_LC_padj.1 <- res_OC_LC_.1_df %>%
rownames_to_column('gene') %>%
as_tibble() %>%
filter(padj < 0.1) %>%
arrange(padj)
head(DE_OC_LC_padj.1)
# save rlogged file
saveRDS(DE_OC_LC_padj.1, file = "Past_Host_DE_genes_OC_LC_padj.1.rds")
write.csv(DE_OC_LC_padj.1, "Past_Host_DE_genes_OC_LC_padj.1.csv")
up.results_OC_LC_padj.1 = row.names(results_OC_LC_.1[results_OC_LC_.1$padj<0.1 & !(is.na(results_OC_LC_.1$padj)) & results_OC_LC_.1$log2FoldChange>0,])
up.results_OC_LC_padj.1 <- as.data.frame(up.results_OC_LC_padj.1)
up.results_OC_LC_padj.1$DEG <- 'Up'
#down.results_OC_LC_padj.1 = row.names(results_OC_LC_.1[results_OC_LC_.1$padj<0.1 & !(is.na(results_OC_LC_.1$padj)) & results_OC_LC_.1$log2FoldChange<0,])
#down.results_OC_LC_padj.1 <- as.data.frame(down.results_OC_LC_padj.1)
#down.results_OC_LC_padj.1$DEG <- 'Down'
#OC_LC_padj.1_summary <- merge(up.results_OC_LC_padj.1, down.results_OC_LC_padj.1, all=T)
#dim(OC_LC_padj.1_summary)
# save file
write.csv(up.results_OC_LC_padj.1, file="Past_Host_DE_genes_OC_LC_padj.1_summary.csv")
up.results_OC_LC_padj.1 = row.names(results_OC_LC_.1[results_OC_LC_.1$padj<0.1 & !(is.na(results_OC_LC_.1$padj)) & results_OC_LC_.1$log2FoldChange>0,])
up.results_OC_LC_padj.1 <- as.data.frame(up.results_OC_LC_padj.1)
up.results_OC_LC_padj.1$DEG <- 'Up'
dim(up.results_OC_LC_padj.1)
#down.results_OC_LC_padj.1 = row.names(results_OC_LC_.1[results_OC_LC_.1$padj<0.1 & !(is.na(results_OC_LC_.1$padj)) & results_OC_LC_.1$log2FoldChange<0,])
#down.results_OC_LC_padj.1 <- as.data.frame(down.results_OC_LC_padj.1)
#down.results_OC_LC_padj.1$DEG <- 'Down'
#OC_LC_padj.1_summary <- merge(up.results_OC_LC_padj.1, down.results_OC_LC_padj.1, all=T)
#dim(OC_LC_padj.1_summary)
# save file
write.csv(up.results_OC_LC_padj.1, file="Past_Host_DE_genes_OC_LC_padj.1_summary.csv")
DE_OC_LC_pvalue <- res_OC_LC_.1_df %>%
rownames_to_column('gene') %>%
as_tibble() %>%
filter(pvalue < 0.05) %>%
arrange(pvalue)
head(DE_OC_LC_pvalue)
# save rlogged and csv files
saveRDS(DE_OC_LC_pvalue, file = "Past_Host_OC_LC_pval.05.rds")
write.csv(DE_OC_LC_pvalue, "Past_Host_OC_LC_pval.05.csv")
dim(DE_OC_LC_pvalue)
results_OO_LC_.1 <- results(dds, contrast = c("group", "Ojo.Ojo", "Lagoon.Control"), alpha = 0.1)
head(results_OO_LC_.1)
summary(results_OO_LC_.1)
rm(list=ls())
