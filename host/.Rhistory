# , posi.inset = "bottomleft" # not working ?
scatter <- scatter(dp2, cex = 1.5, legend = TRUE,
clabel = FALSE, posi.leg = "bottomleft",
cleg = 0.9, xax = 1, yax = 2, col = c("dodgerblue", "gold2", "#163343", "firebrick", "forestgreen", "bisque3")) #inset.solid = 1,
#posi.leg = "topright
#posi.pca = "bottomleft"
# , posi.inset = "bottomleft" # not working ?
scatter(dp2,1,1, bg="white", scree.da=FALSE, legend=TRUE, solid=.4, col = c("dodgerblue", "gold2", "#163343", "firebrick", "forestgreen", "bisque3"), cleg = 0.9, posi.leg = "topleft")
scatter(dp2,1,1, bg="white", scree.da=FALSE, legend=TRUE, solid=.4, col = c("dodgerblue", "gold2", "#163343", "firebrick", "forestgreen", "bisque3"), cleg = 0.9, posi.leg = "topright")
library(tidyverse)
setwd("~/Documents/Rprojects/postdoc\ Rprojects/ODU_postdoc_Rprojects/Paper_Ojo_gene-expression/Porites_astreoides/orthofinder/")
past_seq2iso <- read.table("~/Documents/Postdoc/ODU_postdoc/projects/Ojo_gene-expression/database/pastreoides_2014/pastreoides_may2014/past_seq2iso_suffixed.tab", header = FALSE, sep = "\t", stringsAsFactors=T)
past_seq2iso <- past_seq2iso %>%
dplyr::rename(isotig = V1,
gene = V2)
head(past_seq2iso)
ppor_seq2iso <- read.table("~/Documents/Postdoc/ODU_postdoc/projects/Ojo_gene-expression/database/pastreoides_2014/pastreoides_may2014/past_seq2iso_suffixed_Ppor.tab", header = FALSE, sep = "\t", stringsAsFactors=T)
ppor_seq2iso <- ppor_seq2iso %>%
dplyr::rename(isotig_Ppor = V1,
gene_Ppor = V2)
head(ppor_seq2iso)
seq2iso <- cbind(past_seq2iso, ppor_seq2iso)
head(seq2iso)
orthogroups <- read.table("~/Documents/Rprojects/postdoc\ Rprojects/ODU_postdoc_Rprojects/Paper_Ojo_gene-expression/Porites_astreoides/orthofinder/Sid.v.Past_longestContig/Phylogenetic_Hierarchical_Orthogroups/N0.tsv", header = TRUE, sep = "\t", stringsAsFactors=F) #row.names = 1
orthogroups <- orthogroups %>%
dplyr::rename(orthogroup = HOG,
gene_Sid = X19222_Sid_GoodCoral_500lnThresh_Final,
isotig = X29422_past_LongestContig_suffixed)
dim(orthogroups)
head(orthogroups)
orthogroups <- orthogroups[, c(1,4:5)]
rownames(orthogroups) <- orthogroups$orthogroup
head(orthogroups)
# Split the comma-separated paralogs
ortho.split <- strsplit(as.matrix(orthogroups),", ")
# it's now a list of character vectors
# Add dimensions:
dim(ortho.split) <- dim(orthogroups)
# Add row and column names:
dimnames(ortho.split) <- dimnames(orthogroups)
ortho.split["N0.HOG0000000", ]
ortho.split["N0.HOG0000021", ]
names_orthogroups <- row.names(apply(ortho.split,2,sapply,length))
orthoSize <- apply(ortho.split,2,sapply,length)
orthoSize <- orthoSize[, 2:3]
orthoSize["N0.HOG0000021", ]
plot(table(apply(orthoSize>0,1,sum)),ylab="no. orthogroups",xlab="no. transcriptomes")
sum(apply(orthoSize==1,1,all)) # number of 1:1 groups
#sum(apply(grpSize==1,1,sum)==2 & apply(grpSize > 1,1,sum)==0)
names_1.to.1 <- as.data.frame(apply(orthoSize==1,1,all))
names_1.to.1 <- names_1.to.1 %>%
filter(names_1.to.1$`apply(orthoSize == 1, 1, all)` == TRUE)
names_1.to.1$orthogroups <- rownames(names_1.to.1)
names_1.to.1 <- names_1.to.1[ ,2]
ortho_1.to.1  <- orthogroups[names_1.to.1, ]
ortho_1.to.1[sapply(ortho_1.to.1, is.character)] <- lapply(ortho_1.to.1[sapply(ortho_1.to.1, is.character)], as.factor)
dim(ortho_1.to.1)
head(ortho_1.to.1)
ortho.1.to.1_Past.isotigs <- past_seq2iso %>%
inner_join(ortho_1.to.1, by = "isotig")
head(ortho.1.to.1_Past.isotigs)
names_1.to.1_ppor <- as.data.frame(apply(orthoSize==1,1,all))
names_1.to.1_ppor <- names_1.to.1_ppor %>%
filter(names_1.to.1_ppor$`apply(orthoSize == 1, 1, all)` == TRUE)
names_1.to.1_ppor$orthogroups <- rownames(names_1.to.1_ppor)
names_1.to.1_ppor <- names_1.to.1_ppor[ ,2]
ortho_1.to.1_ppor  <- orthogroups[names_1.to.1_ppor, ]
ortho_1.to.1_ppor[sapply(ortho_1.to.1_ppor, is.character)] <- lapply(ortho_1.to.1_ppor[sapply(ortho_1.to.1_ppor, is.character)], as.factor)
ortho.1.to.1_Ppor.isotigs <- seq2iso %>%
inner_join(ortho_1.to.1_ppor, by = "isotig")
ortho.1.to.1_Ppor.isotigs <- ortho.1.to.1_Ppor.isotigs[ , 3:6]
ortho.1.to.1_Ppor.isotigs <- ortho.1.to.1_Ppor.isotigs %>%
dplyr::rename(isotig = isotig_Ppor,
gene = gene_Ppor)
head(ortho.1.to.1_Ppor.isotigs)
ortho.df <- as.data.frame(ortho.split)
ortho.df <- subset(ortho.df, ortho.df$gene_Sid != "character(0)")
ortho.df <- subset(ortho.df, ortho.df$isotig != "character(0)")
dim(ortho.df)
all(rownames(names_1.to.1) %in% rownames(ortho.df))
all(rownames(names_1.to.1) %in% ortho.df$orthogroup)
# any()
length(match(names_1.to.1, rownames(ortho.df)))
#length(names_1.to.1 %in% rownames(ortho.df))
#length(names_1.to.1 %in% ortho.df$orthogroup)
class(names_1.to.1)
#typeof(names_1.to.1)
head(rownames(ortho.df) %in% names_1.to.1)
names_multi.ortho <- setdiff(rownames(ortho.df), names_1.to.1)
str(names_multi.ortho)
multi.ortho  <- orthogroups[names_multi.ortho, ]
head(multi.ortho)
multi.ortho.Sid <- multi.ortho[ , 1:2]
s <- strsplit(as.character(multi.ortho.Sid$gene_Sid),", ")
head(s, 2)
multi.ortho.Sid <- multi.ortho[ , 1:2]
multi.ortho.Sid <- separate_rows(multi.ortho.Sid, gene_Sid, sep = ", ")
multi.ortho.Sid[sapply(multi.ortho.Sid, is.character)] <- lapply(multi.ortho.Sid[sapply(multi.ortho.Sid, is.character)],
as.factor)
multi.ortho.Sid <- multi.ortho.Sid %>%
dplyr::rename(gene = gene_Sid)
dim(multi.ortho.Sid)
head(multi.ortho.Sid)
multi.ortho.Past <- multi.ortho[ , c(1,3)]
multi.ortho.Past <- separate_rows(multi.ortho.Past, isotig, sep = ", ")
multi.ortho.Past[sapply(multi.ortho.Past, is.character)] <- lapply(multi.ortho.Past[sapply(multi.ortho.Past, is.character)],
as.factor)
dim(multi.ortho.Past)
head(multi.ortho.Past)
multi.ortho.Past.isotigs <- past_seq2iso %>%
inner_join(multi.ortho.Past, by = "isotig")
head(multi.ortho.Past.isotigs)
multi.ortho.Ppor.isotigs <- seq2iso %>%
inner_join(multi.ortho.Past.isotigs, by = "isotig")
multi.ortho.Ppor.isotigs <- multi.ortho.Ppor.isotigs[ , c(3:4,6)]
multi.ortho.Ppor.isotigs <- multi.ortho.Ppor.isotigs %>%
dplyr::rename(isotig = isotig_Ppor,
gene = gene_Ppor)
head(multi.ortho.Ppor.isotigs)
OO_OC_Past <- read.csv("~/Documents/Rprojects/postdoc\ Rprojects/ODU_postdoc_Rprojects/Paper_Ojo_gene-expression/Porites_astreoides/host/Past_Host_DE_genes_OO_OC_padj.1.csv", header = TRUE)
OO_OC_Past$gene <- as.factor(OO_OC_Past$gene)
head(OO_OC_Past)
OO_OC_Sid <- read.csv("~/Documents/Rprojects/postdoc\ Rprojects/ODU_postdoc_Rprojects/Paper_Ojo_gene-expression/Siderastrea/host/Sid_Host_DE_genes_OO_OC_padj.1.csv", header = TRUE)
OO_OC_Sid$gene <- as.factor(OO_OC_Sid$gene)
head(OO_OC_Sid)
any(OO_OC_Sid$gene %in% multi.ortho.Sid$gene)
length(intersect(OO_OC_Sid$gene, multi.ortho.Sid$gene))
length(intersect(OO_OC_Sid$gene, ortho_1.to.1$gene))
length(intersect(OO_OC_Past$gene, multi.ortho.Past.isotigs$gene))
length(intersect(OO_OC_Past$gene, ortho.1.to.1_Past.isotigs$gene))
past_multi.isogroups_OO_OC <- multi.ortho.Past.isotigs %>%
inner_join(OO_OC_Past, by = "gene")
dim(past_multi.isogroups_OO_OC)
head(past_multi.isogroups_OO_OC)
past_multi.isogroups_OO_OC %>% count(orthogroup) %>% filter(n > 1)
past_multi.isogroups_OO_OC <- multi.ortho.Past.isotigs %>%
inner_join(OO_OC_Past, by = "gene")
past_multi.isogroups_OO_OC <- as.data.frame(past_multi.isogroups_OO_OC)
dim(past_multi.isogroups_OO_OC)
head(past_multi.isogroups_OO_OC)
past_multi.isogroups_OO_OC %>% count(orthogroup) %>% filter(n > 1)
past_multi.isogroups_OO_OC[,3] %>% count(orthogroup) %>% filter(n > 1)
library(tidyverse)
setwd("~/Documents/Rprojects/postdoc\ Rprojects/ODU_postdoc_Rprojects/Paper_Ojo_gene-expression/Porites_astreoides/orthofinder/")
past_seq2iso <- read.table("~/Documents/Postdoc/ODU_postdoc/projects/Ojo_gene-expression/database/pastreoides_2014/pastreoides_may2014/past_seq2iso_suffixed.tab", header = FALSE, sep = "\t", stringsAsFactors=T)
past_seq2iso <- past_seq2iso %>%
dplyr::rename(isotig = V1,
gene = V2)
head(past_seq2iso)
ppor_seq2iso <- read.table("~/Documents/Postdoc/ODU_postdoc/projects/Ojo_gene-expression/database/pastreoides_2014/pastreoides_may2014/past_seq2iso_suffixed_Ppor.tab", header = FALSE, sep = "\t", stringsAsFactors=T)
ppor_seq2iso <- ppor_seq2iso %>%
dplyr::rename(isotig_Ppor = V1,
gene_Ppor = V2)
head(ppor_seq2iso)
seq2iso <- cbind(past_seq2iso, ppor_seq2iso)
head(seq2iso)
orthogroups <- read.table("~/Documents/Rprojects/postdoc\ Rprojects/ODU_postdoc_Rprojects/Paper_Ojo_gene-expression/Porites_astreoides/orthofinder/Sid.v.Past_longestContig/Phylogenetic_Hierarchical_Orthogroups/N0.tsv", header = TRUE, sep = "\t", stringsAsFactors=F) #row.names = 1
orthogroups <- orthogroups %>%
dplyr::rename(orthogroup = HOG,
gene_Sid = X19222_Sid_GoodCoral_500lnThresh_Final,
isotig = X29422_past_LongestContig_suffixed)
dim(orthogroups)
head(orthogroups)
orthogroups <- orthogroups[, c(1,4:5)]
rownames(orthogroups) <- orthogroups$orthogroup
head(orthogroups)
# Split the comma-separated paralogs
ortho.split <- strsplit(as.matrix(orthogroups),", ")
# it's now a list of character vectors
# Add dimensions:
dim(ortho.split) <- dim(orthogroups)
# Add row and column names:
dimnames(ortho.split) <- dimnames(orthogroups)
ortho.split["N0.HOG0000000", ]
ortho.split["N0.HOG0000021", ]
names_orthogroups <- row.names(apply(ortho.split,2,sapply,length))
orthoSize <- apply(ortho.split,2,sapply,length)
orthoSize <- orthoSize[, 2:3]
orthoSize["N0.HOG0000021", ]
plot(table(apply(orthoSize>0,1,sum)),ylab="no. orthogroups",xlab="no. transcriptomes")
sum(apply(orthoSize==1,1,all)) # number of 1:1 groups
#sum(apply(grpSize==1,1,sum)==2 & apply(grpSize > 1,1,sum)==0)
names_1.to.1 <- as.data.frame(apply(orthoSize==1,1,all))
names_1.to.1 <- names_1.to.1 %>%
filter(names_1.to.1$`apply(orthoSize == 1, 1, all)` == TRUE)
names_1.to.1$orthogroups <- rownames(names_1.to.1)
names_1.to.1 <- names_1.to.1[ ,2]
ortho_1.to.1  <- orthogroups[names_1.to.1, ]
ortho_1.to.1[sapply(ortho_1.to.1, is.character)] <- lapply(ortho_1.to.1[sapply(ortho_1.to.1, is.character)], as.factor)
dim(ortho_1.to.1)
head(ortho_1.to.1)
ortho.1.to.1_Past.isotigs <- past_seq2iso %>%
inner_join(ortho_1.to.1, by = "isotig")
head(ortho.1.to.1_Past.isotigs)
names_1.to.1_ppor <- as.data.frame(apply(orthoSize==1,1,all))
names_1.to.1_ppor <- names_1.to.1_ppor %>%
filter(names_1.to.1_ppor$`apply(orthoSize == 1, 1, all)` == TRUE)
names_1.to.1_ppor$orthogroups <- rownames(names_1.to.1_ppor)
names_1.to.1_ppor <- names_1.to.1_ppor[ ,2]
ortho_1.to.1_ppor  <- orthogroups[names_1.to.1_ppor, ]
ortho_1.to.1_ppor[sapply(ortho_1.to.1_ppor, is.character)] <- lapply(ortho_1.to.1_ppor[sapply(ortho_1.to.1_ppor, is.character)], as.factor)
ortho.1.to.1_Ppor.isotigs <- seq2iso %>%
inner_join(ortho_1.to.1_ppor, by = "isotig")
ortho.1.to.1_Ppor.isotigs <- ortho.1.to.1_Ppor.isotigs[ , 3:6]
ortho.1.to.1_Ppor.isotigs <- ortho.1.to.1_Ppor.isotigs %>%
dplyr::rename(isotig = isotig_Ppor,
gene = gene_Ppor)
head(ortho.1.to.1_Ppor.isotigs)
ortho.df <- as.data.frame(ortho.split)
ortho.df <- subset(ortho.df, ortho.df$gene_Sid != "character(0)")
ortho.df <- subset(ortho.df, ortho.df$isotig != "character(0)")
dim(ortho.df)
all(rownames(names_1.to.1) %in% rownames(ortho.df))
all(rownames(names_1.to.1) %in% ortho.df$orthogroup)
# any()
length(match(names_1.to.1, rownames(ortho.df)))
#length(names_1.to.1 %in% rownames(ortho.df))
#length(names_1.to.1 %in% ortho.df$orthogroup)
class(names_1.to.1)
#typeof(names_1.to.1)
head(rownames(ortho.df) %in% names_1.to.1)
names_multi.ortho <- setdiff(rownames(ortho.df), names_1.to.1)
str(names_multi.ortho)
multi.ortho  <- orthogroups[names_multi.ortho, ]
head(multi.ortho)
multi.ortho.Sid <- multi.ortho[ , 1:2]
s <- strsplit(as.character(multi.ortho.Sid$gene_Sid),", ")
head(s, 2)
multi.ortho.Sid <- multi.ortho[ , 1:2]
multi.ortho.Sid <- separate_rows(multi.ortho.Sid, gene_Sid, sep = ", ")
multi.ortho.Sid[sapply(multi.ortho.Sid, is.character)] <- lapply(multi.ortho.Sid[sapply(multi.ortho.Sid, is.character)],
as.factor)
multi.ortho.Sid <- multi.ortho.Sid %>%
dplyr::rename(gene = gene_Sid)
dim(multi.ortho.Sid)
head(multi.ortho.Sid)
multi.ortho.Past <- multi.ortho[ , c(1,3)]
multi.ortho.Past <- separate_rows(multi.ortho.Past, isotig, sep = ", ")
multi.ortho.Past[sapply(multi.ortho.Past, is.character)] <- lapply(multi.ortho.Past[sapply(multi.ortho.Past, is.character)],
as.factor)
dim(multi.ortho.Past)
head(multi.ortho.Past)
multi.ortho.Past.isotigs <- past_seq2iso %>%
inner_join(multi.ortho.Past, by = "isotig")
head(multi.ortho.Past.isotigs)
multi.ortho.Ppor.isotigs <- seq2iso %>%
inner_join(multi.ortho.Past.isotigs, by = "isotig")
multi.ortho.Ppor.isotigs <- multi.ortho.Ppor.isotigs[ , c(3:4,6)]
multi.ortho.Ppor.isotigs <- multi.ortho.Ppor.isotigs %>%
dplyr::rename(isotig = isotig_Ppor,
gene = gene_Ppor)
head(multi.ortho.Ppor.isotigs)
OO_OC_Past <- read.csv("~/Documents/Rprojects/postdoc\ Rprojects/ODU_postdoc_Rprojects/Paper_Ojo_gene-expression/Porites_astreoides/host/Past_Host_DE_genes_OO_OC_padj.1.csv", header = TRUE)
OO_OC_Past$gene <- as.factor(OO_OC_Past$gene)
head(OO_OC_Past)
OO_OC_Sid <- read.csv("~/Documents/Rprojects/postdoc\ Rprojects/ODU_postdoc_Rprojects/Paper_Ojo_gene-expression/Siderastrea/host/Sid_Host_DE_genes_OO_OC_padj.1.csv", header = TRUE)
OO_OC_Sid$gene <- as.factor(OO_OC_Sid$gene)
head(OO_OC_Sid)
any(OO_OC_Sid$gene %in% multi.ortho.Sid$gene)
length(intersect(OO_OC_Sid$gene, multi.ortho.Sid$gene))
length(intersect(OO_OC_Sid$gene, ortho_1.to.1$gene))
length(intersect(OO_OC_Past$gene, multi.ortho.Past.isotigs$gene))
length(intersect(OO_OC_Past$gene, ortho.1.to.1_Past.isotigs$gene))
past_multi.isogroups_OO_OC <- multi.ortho.Past.isotigs %>%
inner_join(OO_OC_Past, by = "gene")
#past_multi.isogroups_OO_OC <- as.data.frame(past_multi.isogroups_OO_OC)
dim(past_multi.isogroups_OO_OC)
head(past_multi.isogroups_OO_OC)
past_multi.isogroups_OO_OC[,3] %>% count(orthogroup) %>% filter(n > 1)
past_multi.isogroups_OO_OC[,3] %>% dplyr::count(orthogroup) %>% filter(n > 1)
past_multi.isogroups_OO_OC[,3] %>% plyr::count(orthogroup) %>% filter(n > 1)
past_multi.isogroups_OO_OC %>% dplyr::count(orthogroup) %>% filter(n > 1)
past_multi.isogroups_OO_OC %>%
group_by(orthogroup) %>%
filter(n()>1)
past_1.to.1.isogroups_OO_OC <- ortho.1.to.1_Past.isotigs %>%
inner_join(OO_OC_Past, by = "gene")
dim(past_1.to.1.isogroups_OO_OC)
head(past_1.to.1.isogroups_OO_OC)
past_1.to.1.isogroups_OO_OC %>% dplyr::count(orthogroup) %>% filter(n > 1)
OO_LO_Past <- read.csv("~/Documents/Rprojects/postdoc\ Rprojects/ODU_postdoc_Rprojects/Paper_Ojo_gene-expression/Porites_astreoides/host/Past_Host_DE_genes_OO_LO_padj.1.csv", header = TRUE)
OO_LO_Past$gene <- as.factor(OO_LO_Past$gene)
head(OO_LO_Past)
OO_LO_Sid <- read.csv("~/Documents/Rprojects/postdoc\ Rprojects/ODU_postdoc_Rprojects/Paper_Ojo_gene-expression/Siderastrea/host/Sid_Host_DE_genes_OO_LO_padj.1.csv", header = TRUE)
OO_LO_Sid$gene <- as.factor(OO_LO_Sid$gene)
head(OO_LO_Sid)
any(OO_LO_Sid$gene %in% multi.ortho.Sid$gene)
length(intersect(OO_LO_Sid$gene, multi.ortho.Sid$gene))
length(intersect(OO_LO_Sid$gene, ortho_1.to.1$gene))
length(intersect(OO_LO_Past$gene, multi.ortho.Past.isotigs$gene))
length(intersect(OO_LO_Past$gene, ortho.1.to.1_Past.isotigs$gene))
past_multi.isogroups_OO_LO <- multi.ortho.Past.isotigs %>%
inner_join(OO_LO_Past, by = "gene")
dim(past_multi.isogroups_OO_LO)
past_multi.isogroups_OO_LO <- multi.ortho.Past.isotigs %>%
inner_join(OO_LO_Past, by = "gene")
dim(past_multi.isogroups_OO_LO)
head(past_multi.isogroups_OO_LO)
past_multi.isogroups_OO_LO %>% count(orthogroup) %>% filter(n > 1)
past_multi.isogroups_OO_LO %>% dplyr::count(orthogroup) %>% filter(n > 1)
past_multi.isogroups_OO_LO %>%
group_by(orthogroup) %>%
filter(n()>1)
past_1.to.1.isogroups_OO_LO <- ortho.1.to.1_Past.isotigs %>%
inner_join(OO_LO_Past, by = "gene")
dim(past_1.to.1.isogroups_OO_LO)
head(past_1.to.1.isogroups_OO_LO)
past_1.to.1.isogroups_OO_LO %>% count(orthogroup) %>% filter(n > 1)
past_1.to.1.isogroups_OO_LO %>% dplyr::count(orthogroup) %>% filter(n > 1)
LO_LC_Past <- read.csv("~/Documents/Rprojects/postdoc\ Rprojects/ODU_postdoc_Rprojects/Paper_Ojo_gene-expression/Porites_astreoides/host/Past_Host_DE_genes_LO_LC_padj.1.csv", header = TRUE)
LO_LC_Past$gene <- as.factor(LO_LC_Past$gene)
head(LO_LC_Past)
OC_LC_Past <- read.csv("~/Documents/Rprojects/postdoc\ Rprojects/ODU_postdoc_Rprojects/Paper_Ojo_gene-expression/Porites_astreoides/host/Past_Host_DE_genes_OC_LC_padj.1.csv", header = TRUE)
OC_LC_Past$gene <- as.factor(OC_LC_Past$gene)
head(OC_LC_Past)
OC_LC_Sid <- read.csv("~/Documents/Rprojects/postdoc\ Rprojects/ODU_postdoc_Rprojects/Paper_Ojo_gene-expression/Siderastrea/host/Sid_Host_DE_genes_OC_LC_padj.1.csv", header = TRUE)
OC_LC_Sid$gene <- as.factor(OC_LC_Sid$gene)
head(OC_LC_Sid)
any(OC_LC_Sid$gene %in% multi.ortho.Sid$gene)
length(intersect(OC_LC_Sid$gene, multi.ortho.Sid$gene))
length(intersect(OC_LC_Sid$gene, ortho_1.to.1$gene))
length(intersect(OC_LC_Past$gene, multi.ortho.Past.isotigs$gene))
length(intersect(OC_LC_Past$gene, ortho.1.to.1_Past.isotigs$gene))
past_1.to.1.isogroups_OC_LC <- ortho.1.to.1_Past.isotigs %>%
inner_join(OC_LC_Past, by = "gene")
dim(past_1.to.1.isogroups_OC_LC)
head(past_1.to.1.isogroups_OC_LC)
RO_RC_Ppor <- read.csv("~/Documents/Rprojects/postdoc\ Rprojects/ODU_postdoc_Rprojects/Paper_Ojo_gene-expression/Porites_porites/host/Ppor_Host_DE_genes_RO_RC_padj.1.csv", header = TRUE)
RO_RC_Ppor$gene <- as.factor(RO_RC_Ppor$gene)
head(RO_RC_Ppor)
RO_RC_Sid <- read.csv("~/Documents/Rprojects/postdoc\ Rprojects/ODU_postdoc_Rprojects/Paper_Ojo_gene-expression/Siderastrea/host/Sid_Host_DE_genes_RO_RC_padj.1.csv", header = TRUE)
RO_RC_Sid$gene <- as.factor(RO_RC_Sid$gene)
head(RO_RC_Sid)
any(RO_RC_Sid$gene %in% multi.ortho.Sid$gene)
length(intersect(RO_RC_Sid$gene, multi.ortho.Sid$gene))
length(intersect(RO_RC_Sid$gene, ortho_1.to.1$gene))
sid_multi.isogroups_RO_RC <- multi.ortho.Sid %>%
inner_join(RO_RC_Sid, by = "gene")
dim(sid_multi.isogroups_RO_RC)
head(sid_multi.isogroups_RO_RC)
sid_multi.isogroups_RO_RC %>% dplyr::count(orthogroup) %>% filter(n > 1)
sid_multi.isogroups_RO_RC %>%
group_by(orthogroup) %>%
filter(n()>1)
ortho_1.to.1 <- ortho_1.to.1 %>%
dplyr::rename(gene = gene_Sid)
sid_1.to.1.isogroups_RO_RC <- ortho_1.to.1 %>%
inner_join(RO_RC_Sid, by = "gene")
dim(sid_1.to.1.isogroups_RO_RC)
head(sid_1.to.1.isogroups_RO_RC)
sid_1.to.1.isogroups_RO_RC %>% count(orthogroup) %>% filter(n > 1)
sid_1.to.1.isogroups_RO_RC %>% dplyr::count(orthogroup) %>% filter(n > 1)
length(intersect(RO_RC_Ppor$gene, multi.ortho.Ppor.isotigs$gene))
ppor_multi.isogroups_RO_RC <- multi.ortho.Ppor.isotigs %>%
inner_join(RO_RC_Ppor, by = "gene")
dim(ppor_multi.isogroups_RO_RC)
ppor_multi.isogroups_RO_RC %>% count(orthogroup) %>% filter(n > 1)
ppor_multi.isogroups_RO_RC %>% dplyr::count(orthogroup) %>% filter(n > 1)
ppor_multi.isogroups_RO_RC %>%
group_by(orthogroup) %>%
filter(n()>1)
length(intersect(RO_RC_Ppor$gene, ortho.1.to.1_Ppor.isotigs$gene))
length(intersect(RO_RC_Ppor$gene, ortho.1.to.1_Ppor.isotigs$gene))
length(intersect(sid_multi.isogroups_RO_RC$orthogroup, ppor_multi.isogroups_RO_RC$orthogroup))
head(sid_multi.isogroups_RO_RC$orthogroup)
head(ppor_multi.isogroups_RO_RC$orthogroup)
View(ppor_multi.isogroups_RO_RC)
View(sid_multi.isogroups_RO_RC)
rm(list=ls())
library(VennDiagram)
setwd("~/Documents/Rprojects/postdoc\ Rprojects/ODU_postdoc_Rprojects/Paper_Ojo_gene-expression/Porites_astreoides/host/")
de.genes_LO_LC <- readRDS("Past_Host_DE_genes_LO_LC_padj.1.rds")
de.genes_LO_LC <- as.data.frame(de.genes_LO_LC)
de.genes_LO_LC$group <- 'LO_LC'
de.genes_LO_LC$group <- as.factor(de.genes_LO_LC$group)
de.genes_LO_LC$expression <- ifelse(de.genes_LO_LC$log2FoldChange>0, 'up', 'down')
de.genes_LO_LC$expression <- as.factor(de.genes_LO_LC$expression)
dim(de.genes_LO_LC)
LO_LC.up <- subset(de.genes_LO_LC, expression == "up")
dim(LO_LC.up)
LO_LC.down <- subset(de.genes_LO_LC, expression == "down")
dim(LO_LC.down)
de.genes_OO_LO <- readRDS("Past_Host_DE_genes_OO_LO_padj.1.rds")
de.genes_OO_LO <- as.data.frame(de.genes_OO_LO)
de.genes_OO_LO$group <- 'OO_LO'
de.genes_OO_LO$group <- as.factor(de.genes_OO_LO$group)
de.genes_OO_LO$expression <- ifelse(de.genes_OO_LO$log2FoldChange>0, 'up', 'down')
de.genes_OO_LO$expression <- as.factor(de.genes_OO_LO$expression)
dim(de.genes_OO_LO)
OO_LO.up <- subset(de.genes_OO_LO, expression == "up")
dim(OO_LO.up)
OO_LO.down <- subset(de.genes_OO_LO, expression == "down")
dim(OO_LO.down)
de.genes_OO_OC <- readRDS("Past_Host_DE_genes_OO_OC_padj.1.rds")
de.genes_OO_OC <- as.data.frame(de.genes_OO_OC)
de.genes_OO_OC$group <- 'OO_OC'
de.genes_OO_OC$group <- as.factor(de.genes_OO_OC$group)
de.genes_OO_OC$expression <- ifelse(de.genes_OO_OC$log2FoldChange>0, 'up', 'down')
de.genes_OO_OC$expression <- as.factor(de.genes_OO_OC$expression)
dim(de.genes_OO_OC)
OO_OC.up <- subset(de.genes_OO_OC, expression == "up")
dim(OO_OC.up)
OO_OC.down <- subset(de.genes_OO_OC, expression == "down")
dim(OO_OC.down)
de.genes_OC_LC <- readRDS("Past_Host_DE_genes_OC_LC_padj.1.rds")
de.genes_OC_LC <- as.data.frame(de.genes_OC_LC)
de.genes_OC_LC$group <- 'OC_LC'
de.genes_OC_LC$group <- as.factor(de.genes_OC_LC$group)
de.genes_OC_LC$expression <- ifelse(de.genes_OC_LC$log2FoldChange>0, 'up', 'down')
de.genes_OC_LC$expression <- as.factor(de.genes_OC_LC$expression)
dim(de.genes_OC_LC)
OC_LC.up <- subset(de.genes_OC_LC, expression == "up")
dim(OC_LC.up)
OC_LC.down <- subset(de.genes_OC_LC, expression == "down")
dim(OC_LC.down)
venn.diagram(x = list(LO_LC.up$gene, OO_LO.up$gene, OO_OC.up$gene),
category.names = c("", "", ""),
filename = 'Past_Host_venn_up.png',
output = TRUE,
imagetype="png",
height = 2500,
width = 6000,
resolution = 300,
fill=c("cadetblue2", "darkseagreen2", "coral1"), #, "goldenrod"
main.cex = 1.5,
sub.cex = 1.5,
cat.cex = 1.5,
cex = 1.5,
cat.default.pos = "outer",
#cat.pos = c(-27, 27, 135, 135, 27),
#cat.dist = c(0.055, 0.055, 0.055, 0.055, 0.055),
main = "",
scaled = FALSE)
#cat.pos = c(0, 0),
venn.diagram(x = list(LO_LC.up$gene, OO_LO.up$gene, OO_OC.up$gene),
category.names = c("", "", ""),
filename = 'Past_Host_venn_up.png',
output = TRUE,
imagetype="png",
height = 500,
width = 1000,
resolution = 300,
fill=c("cadetblue2", "darkseagreen2", "coral1"), #, "goldenrod"
main.cex = 1.5,
sub.cex = 1.5,
cat.cex = 1.5,
cex = 1.5,
cat.default.pos = "outer",
#cat.pos = c(-27, 27, 135, 135, 27),
#cat.dist = c(0.055, 0.055, 0.055, 0.055, 0.055),
main = "",
scaled = FALSE)
#cat.pos = c(0, 0),
venn.diagram(x = list(LO_LC.up$gene, OO_LO.up$gene, OO_OC.up$gene),
category.names = c("", "", ""),
filename = 'Past_Host_venn_up.png',
output = TRUE,
imagetype="png",
height = 1000,
width = 3000,
resolution = 300,
fill=c("cadetblue2", "darkseagreen2", "coral1"), #, "goldenrod"
main.cex = 1.5,
sub.cex = 1.5,
cat.cex = 1.5,
cex = 1.5,
cat.default.pos = "outer",
#cat.pos = c(-27, 27, 135, 135, 27),
#cat.dist = c(0.055, 0.055, 0.055, 0.055, 0.055),
main = "",
scaled = FALSE)
#cat.pos = c(0, 0),
venn.diagram(x = list(LO_LC.up$gene, OO_LO.up$gene, OO_OC.up$gene),
category.names = c("", "", ""),
filename = 'Past_Host_venn_up.png',
output = TRUE,
imagetype="png",
height = 2500,
width = 3000,
resolution = 300,
fill=c("cadetblue2", "darkseagreen2", "coral1"), #, "goldenrod"
main.cex = 1.5,
sub.cex = 1.5,
cat.cex = 1.5,
cex = 1.5,
cat.default.pos = "outer",
#cat.pos = c(-27, 27, 135, 135, 27),
#cat.dist = c(0.055, 0.055, 0.055, 0.055, 0.055),
main = "",
scaled = FALSE)
#cat.pos = c(0, 0),
venn.diagram(x = list(LO_LC.up$gene, OO_LO.up$gene, OO_OC.up$gene),
category.names = c("Lagoon-Ojo vs Lagoon-Control", "Ojo-Ojo vs Lagoon-Ojo", "Ojo-Ojo vs Ojo-Control"),
filename = 'Past_Host_venn_up_labels.png',
output = TRUE,
imagetype="png",
height = 2500,
width = 3000,
resolution = 300,
fill=c("cadetblue2", "darkseagreen2", "coral1"), #, "goldenrod"
main.cex = 1.5,
sub.cex = 1.5,
cat.cex = 1.5,
cex = 1.5,
cat.default.pos = "outer",
#cat.pos = c(-27, 27, 135, 135, 27),
#cat.dist = c(0.055, 0.055, 0.055, 0.055, 0.055),
main = "",
scaled = FALSE)
#cat.pos = c(0, 0),
rm(list=ls())
citation("ggplot2")
