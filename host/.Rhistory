summary2$Destination <- as.factor(summary2$Destination)
summary2$Destination <- factor(summary2$Destination, levels = c("Ambient", "Low pH", "Ambient vs. Low pH"))
# levels(summary2$group)
# "OC-LC" "OO-LO" "LO-LC" "OO-OC"
summary2$group <- revalue(summary2$group, c("OC-LC" = "Lagoon vs. Ojo", "OO-LO" = "Lagoon vs. Ojo", "LO-LC" = "Lagoon", "OO-OC" = "Ojo"))
summary2
summary2 <- rbind(summary_DEG_1, summary_DEG_2, summary_DEG_3, summary_DEG_4)
summary2
summary2$Destination <- c("Control", "Control", "Low pH", "Low pH", "Ambient vs. Low pH", "Ambient vs. Low pH", "Ambient vs. Low pH", "Ambient vs. Low pH") # "Ojo vs. Control", "Ojo"
summary2$Destination <- as.factor(summary2$Destination)
summary2$Destination <- factor(summary2$Destination, levels = c("Ambient", "Low pH", "Ambient vs. Low pH"))
summary2
summary2 <- rbind(summary_DEG_1, summary_DEG_2, summary_DEG_3, summary_DEG_4)
summary2
summary2$Destination <- c("Ambient", "Ambient", "Low pH", "Low pH", "Ambient vs. Low pH", "Ambient vs. Low pH", "Ambient vs. Low pH", "Ambient vs. Low pH") # "Ojo vs. Control", "Ojo"
summary2$Destination <- as.factor(summary2$Destination)
summary2$Destination <- factor(summary2$Destination, levels = c("Ambient", "Low pH", "Ambient vs. Low pH"))
# levels(summary2$group)
# "OC-LC" "OO-LO" "LO-LC" "OO-OC"
summary2$group <- revalue(summary2$group, c("OC-LC" = "Lagoon vs. Ojo", "OO-LO" = "Lagoon vs. Ojo", "LO-LC" = "Lagoon", "OO-OC" = "Ojo"))
summary2
plot.combo <- ggplot(summary2, aes(x = group, fill = LFC)) +
facet_wrap(~Destination, scales = "free_x") +
geom_bar(data=subset(summary2, LFC=="Up"), aes(y=n, fill = LFC), stat = "identity", width=0.6) + #, binwidth=0
geom_bar(data=subset(summary2, LFC=="Down"), aes(y=n, fill = LFC), stat = "identity", width=0.6) + #, binwidth=0
geom_text(data=subset(summary2, LFC=="Up"), aes(group, n, label = n), position = position_dodge(width=0.9), vjust = -0.5) +
geom_text(data=subset(summary2, LFC=="Down"), aes(group, n, label = -n), position = position_dodge(width=0.9), vjust = 1.5) +
scale_fill_manual("LFC", values=c("black", "#56B4E9"), labels=c("Down-regulated", "Up-regulated"), guide=guide_legend(reverse=TRUE)) + #colorblind friendly
ylab("Differentially expressed genes") +
xlab("Origin") +
scale_y_continuous(limits = c(-260, 160), breaks = seq(-250, 150, by = 50)) +
theme_classic() +
theme(legend.position = c(0.84, 0.2), legend.background = element_blank(), panel.background = element_rect(colour = "black"), axis.text.x = element_text(vjust = 0.5))
# axis.text.x   angle = 45,
# bottom right embedded inside plot c(0.13, 0.18)
#legend.position = "bottom",
#axis.text.x=element_text(vjust=0.5, size=10, face="italic"),
plot.combo
plot.combo <- ggplot(summary2, aes(x = group, fill = LFC)) +
facet_wrap(~Destination, scales = "free_x") +
geom_bar(data=subset(summary2, LFC=="Up"), aes(y=n, fill = LFC), stat = "identity", width=0.6) + #, binwidth=0
geom_bar(data=subset(summary2, LFC=="Down"), aes(y=n, fill = LFC), stat = "identity", width=0.6) + #, binwidth=0
geom_text(data=subset(summary2, LFC=="Up"), aes(group, n, label = n), position = position_dodge(width=0.9), vjust = -0.5) +
geom_text(data=subset(summary2, LFC=="Down"), aes(group, n, label = -n), position = position_dodge(width=0.9), vjust = 1.5) +
scale_fill_manual("LFC", values=c("black", "#56B4E9"), labels=c("Down-regulated", "Up-regulated"), guide=guide_legend(reverse=TRUE)) + #colorblind friendly
ylab("Differentially expressed genes") +
xlab("Origin") +
scale_y_continuous(limits = c(-260, 160), breaks = seq(-250, 150, by = 50)) +
theme_classic() +
theme(legend.position = c(0.13, 0.18), legend.background = element_blank(), panel.background = element_rect(colour = "black"), axis.text.x = element_text(vjust = 0.5))
# axis.text.x   angle = 45,
# bottom right embedded inside plot c(0.84, 0.2)
#legend.position = "bottom",
#axis.text.x=element_text(vjust=0.5, size=10, face="italic"),
plot.combo
plot.combo <- ggplot(summary2, aes(x = group, fill = LFC)) +
facet_wrap(~Destination, scales = "free_x") +
geom_bar(data=subset(summary2, LFC=="Up"), aes(y=n, fill = LFC), stat = "identity", width=0.6) + #, binwidth=0
geom_bar(data=subset(summary2, LFC=="Down"), aes(y=n, fill = LFC), stat = "identity", width=0.6) + #, binwidth=0
geom_text(data=subset(summary2, LFC=="Up"), aes(group, n, label = n), position = position_dodge(width=0.9), vjust = -0.5) +
geom_text(data=subset(summary2, LFC=="Down"), aes(group, n, label = -n), position = position_dodge(width=0.9), vjust = 1.5) +
scale_fill_manual("LFC", values=c("black", "#56B4E9"), labels=c("Down-regulated", "Up-regulated"), guide=guide_legend(reverse=TRUE)) + #colorblind friendly
ylab("Differentially expressed genes") +
xlab("Native") +
scale_y_continuous(limits = c(-260, 160), breaks = seq(-250, 150, by = 50)) +
theme_classic() +
theme(legend.position = c(0.13, 0.18), legend.background = element_blank(), panel.background = element_rect(colour = "black"), axis.text.x = element_text(vjust = 0.5))
# axis.text.x   angle = 45,
# bottom right embedded inside plot c(0.84, 0.2)
#legend.position = "bottom",
#axis.text.x=element_text(vjust=0.5, size=10, face="italic"),
plot.combo
# save plot
ggsave("Past_Host_DEG_barplot_Low-pH-label.pdf", plot = plot.combo,  width = 5, height = 3, units = "in", dpi = 1200) #width = 6.5, height = 4.5
plot.combo <- ggplot(summary2, aes(x = group, fill = LFC)) +
facet_wrap(~Destination, scales = "free_x") +
geom_bar(data=subset(summary2, LFC=="Up"), aes(y=n, fill = LFC), stat = "identity", width=0.6) + #, binwidth=0
geom_bar(data=subset(summary2, LFC=="Down"), aes(y=n, fill = LFC), stat = "identity", width=0.6) + #, binwidth=0
geom_text(data=subset(summary2, LFC=="Up"), aes(group, n, label = n), position = position_dodge(width=0.9), vjust = -0.5) +
geom_text(data=subset(summary2, LFC=="Down"), aes(group, n, label = -n), position = position_dodge(width=0.9), vjust = 1.5) +
scale_fill_manual("LFC", values=c("black", "#56B4E9"), labels=c("Down-regulated", "Up-regulated"), guide=guide_legend(reverse=TRUE)) + #colorblind friendly
ylab("Differentially expressed genes") +
xlab("Native") +
scale_y_continuous(limits = c(-260, 160), breaks = seq(-250, 150, by = 50)) +
theme_classic() +
theme(legend.position = c(0.18, 0.18), legend.background = element_blank(), panel.background = element_rect(colour = "black"), axis.text.x = element_text(vjust = 0.5))
# axis.text.x   angle = 45,
# bottom right embedded inside plot c(0.84, 0.2)
#legend.position = "bottom",
#axis.text.x=element_text(vjust=0.5, size=10, face="italic"),
plot.combo
# save plot
ggsave("Past_Host_DEG_barplot_Low-pH-label.pdf", plot = plot.combo,  width = 5, height = 3, units = "in", dpi = 1200) #width = 6.5, height = 4.5
plot.combo <- ggplot(summary2, aes(x = group, fill = LFC)) +
facet_wrap(~Destination, scales = "free_x") +
geom_bar(data=subset(summary2, LFC=="Up"), aes(y=n, fill = LFC), stat = "identity", width=0.6) + #, binwidth=0
geom_bar(data=subset(summary2, LFC=="Down"), aes(y=n, fill = LFC), stat = "identity", width=0.6) + #, binwidth=0
geom_text(data=subset(summary2, LFC=="Up"), aes(group, n, label = n), position = position_dodge(width=0.9), vjust = -0.5) +
geom_text(data=subset(summary2, LFC=="Down"), aes(group, n, label = -n), position = position_dodge(width=0.9), vjust = 1.5) +
scale_fill_manual("LFC", values=c("black", "#56B4E9"), labels=c("Down-regulated", "Up-regulated"), guide=guide_legend(reverse=TRUE)) + #colorblind friendly
ylab("Differentially expressed genes") +
xlab("Native") +
scale_y_continuous(limits = c(-260, 160), breaks = seq(-250, 150, by = 50)) +
theme_classic() +
theme(legend.position = c(0.16, 0.18), legend.background = element_blank(), panel.background = element_rect(colour = "black"), axis.text.x = element_text(vjust = 0.5))
# axis.text.x   angle = 45,
# bottom right embedded inside plot c(0.84, 0.2)
#legend.position = "bottom",
#axis.text.x=element_text(vjust=0.5, size=10, face="italic"),
plot.combo
# save plot
ggsave("Past_Host_DEG_barplot_Low-pH-label.pdf", plot = plot.combo,  width = 5, height = 3, units = "in", dpi = 1200) #width = 6.5, height = 4.5
library(ggplot2)
library(scales)
library(dplyr)
library(plyr)
setwd("~/Documents/Rprojects/postdoc\ Rprojects/ODU_postdoc_Rprojects/Paper_Ojo_gene-expression/Porites_porites/host/")
# import data
de.genes <- readRDS("Ppor_Host_DE_genes_RO_RC_padj.1.rds")
# add group pairwise contrast label
de.genes$group <- 'RO-RC'
de.genes$group <- as.factor(de.genes$group)
dim(de.genes)
summary_DEG$Destination <- c("Ambient vs. Low pH")
summary_DEG$group <- revalue(summary_DEG$group, c("RO-RC" = "Reef"))
summary_DEG
library(ggplot2)
library(scales)
library(dplyr)
library(plyr)
setwd("~/Documents/Rprojects/postdoc\ Rprojects/ODU_postdoc_Rprojects/Paper_Ojo_gene-expression/Porites_porites/host/")
# import data
de.genes <- readRDS("Ppor_Host_DE_genes_RO_RC_padj.1.rds")
# add group pairwise contrast label
de.genes$group <- 'RO-RC'
de.genes$group <- as.factor(de.genes$group)
dim(de.genes)
de.genes$LFC <- ifelse(de.genes$log2FoldChange>0, 'Up', 'Down')
de.genes$LFC <- as.factor(de.genes$LFC)
summary_DEG <- de.genes %>% dplyr::count(group, LFC)
summary_DEG$LFC <- factor(summary_DEG$LFC, levels = c("Up", "Down"))
summary_DEG[1,3] <- summary_DEG[1,3]*(-1)
summary_DEG
summary_DEG$Destination <- c("Ambient vs. Low pH")
summary_DEG$group <- revalue(summary_DEG$group, c("RO-RC" = "Reef"))
summary_DEG
plot.combo <- ggplot(summary_DEG, aes(x = group, fill = LFC)) +
facet_wrap(~Destination, scales = "free_x") +
geom_bar(data=subset(summary_DEG, LFC=="Up"), aes(y=n, fill = LFC), stat = "identity", width=0.6) + #, binwidth=0
geom_bar(data=subset(summary_DEG, LFC=="Down"), aes(y=n, fill = LFC), stat = "identity", width=0.6) + #, binwidth=0
geom_text(data=subset(summary_DEG, LFC=="Up"), aes(group, n, label = n), position = position_dodge(width=0.9), vjust = -0.5) +
geom_text(data=subset(summary_DEG, LFC=="Down"), aes(group, n, label = -n), position = position_dodge(width=0.9), vjust = 1.5) +
scale_fill_manual("LFC", values=c("black", "#56B4E9"), labels=c("Down-regulated", "Up-regulated"), guide=guide_legend(reverse=TRUE)) + #colorblind friendly
ylab("Differentially expressed genes") +
xlab("Transplantation") +
scale_y_continuous(limits = c(-870, 500), breaks = seq(-800, 400, by = 200)) +
theme_classic() +
theme(legend.position = "none", panel.background = element_rect(colour = "black"), axis.text.x = element_text(angle = 45, vjust = 0.5)) #axis.text.x=element_text(vjust=0.5, size=10, face="italic"), #legend.position = "bottom",
plot.combo
plot.combo <- ggplot(summary_DEG, aes(x = group, fill = LFC)) +
facet_wrap(~Destination, scales = "free_x") +
geom_bar(data=subset(summary_DEG, LFC=="Up"), aes(y=n, fill = LFC), stat = "identity", width=0.6) + #, binwidth=0
geom_bar(data=subset(summary_DEG, LFC=="Down"), aes(y=n, fill = LFC), stat = "identity", width=0.6) + #, binwidth=0
geom_text(data=subset(summary_DEG, LFC=="Up"), aes(group, n, label = n), position = position_dodge(width=0.9), vjust = -0.5) +
geom_text(data=subset(summary_DEG, LFC=="Down"), aes(group, n, label = -n), position = position_dodge(width=0.9), vjust = 1.5) +
scale_fill_manual("LFC", values=c("black", "#56B4E9"), labels=c("Down-regulated", "Up-regulated"), guide=guide_legend(reverse=TRUE)) + #colorblind friendly
ylab("Differentially expressed genes") +
xlab("Transplantation") +
scale_y_continuous(limits = c(-260, 160), breaks = seq(-250, 150, by = 50)) +
theme_classic() +
theme(legend.position = "none", panel.background = element_rect(colour = "black"), axis.text.x = element_text(vjust = 0.5)) #axis.text.x=element_text(vjust=0.5, size=10, face="italic", angle = 45), #legend.position = "bottom",
plot.combo
plot.combo <- ggplot(summary_DEG, aes(x = group, fill = LFC)) +
facet_wrap(~Destination, scales = "free_x") +
geom_bar(data=subset(summary_DEG, LFC=="Up"), aes(y=n, fill = LFC), stat = "identity", width=0.6) + #, binwidth=0
geom_bar(data=subset(summary_DEG, LFC=="Down"), aes(y=n, fill = LFC), stat = "identity", width=0.6) + #, binwidth=0
geom_text(data=subset(summary_DEG, LFC=="Up"), aes(group, n, label = n), position = position_dodge(width=0.9), vjust = -0.5) +
geom_text(data=subset(summary_DEG, LFC=="Down"), aes(group, n, label = -n), position = position_dodge(width=0.9), vjust = 1.5) +
scale_fill_manual("LFC", values=c("black", "#56B4E9"), labels=c("Down-regulated", "Up-regulated"), guide=guide_legend(reverse=TRUE)) + #colorblind friendly
ylab("Differentially expressed genes") +
xlab("Native") +
scale_y_continuous(limits = c(-260, 160), breaks = seq(-250, 150, by = 50)) +
theme_classic() +
theme(legend.position = "none", panel.background = element_rect(colour = "black"), axis.text.x = element_text(vjust = 0.5)) #axis.text.x=element_text(vjust=0.5, size=10, face="italic", angle = 45), #legend.position = "bottom",
plot.combo
# save plot
ggsave("Ppor_Host_DEG_barplot_Low-pH-label.pdf", plot = plot.combo,  width = 1.5, height = 3, units = "in", dpi = 1200)
# save plot
ggsave("Ppor_Host_DEG_barplot_Low-pH-label.pdf", plot = plot.combo,  width = 2, height = 3, units = "in", dpi = 1200)
library(ggplot2)
library(scales)
library(dplyr)
library(plyr)
setwd("~/Documents/Rprojects/postdoc\ Rprojects/ODU_postdoc_Rprojects/Paper_Ojo_gene-expression/Siderastrea/host/")
# import data
de.genes <- readRDS("Sid_Host_DE_genes_OC_LC_padj.1.rds")
# add group pairwise contrast label
de.genes$group <- 'OC-LC'
de.genes$group <- as.factor(de.genes$group)
de.genes$LFC <- ifelse(de.genes$log2FoldChange>0, 'Up', 'Down')
de.genes$LFC <- as.factor(de.genes$LFC)
summary_DEG <- de.genes %>% dplyr::count(group, LFC)
summary_DEG$LFC <- factor(summary_DEG$LFC, levels = c("Up", "Down"))
summary_DEG[1,3] <- summary_DEG[1,3]*(-1)
summary_DEG_1a <- summary_DEG
summary_DEG_1b <- data.frame("group" = "OC-LC", "LFC" = "Up", "n" = 0)
summary_DEG_1 <- rbind(summary_DEG_1a, summary_DEG_1b)
summary_DEG_1[sapply(summary_DEG_1, is.character)] <- lapply(summary_DEG_1[sapply(summary_DEG_1, is.character)], as.factor)
summary_DEG_1
# import data
de.genes <- readRDS("Sid_Host_DE_genes_OC_RC_padj.1.rds")
# add group pairwise contrast label
de.genes$group <- 'OC-RC'
de.genes$group <- as.factor(de.genes$group)
dim(de.genes)
de.genes$LFC <- ifelse(de.genes$log2FoldChange>0, 'Up', 'Down')
de.genes$LFC <- as.factor(de.genes$LFC)
summary_DEG <- de.genes %>% dplyr::count(group, LFC)
summary_DEG$LFC <- factor(summary_DEG$LFC, levels = c("Up", "Down"))
summary_DEG[1,3] <- summary_DEG[1,3]*(-1)
summary_DEG_2 <- summary_DEG
summary_DEG_2
# import data
de.genes <- readRDS("Sid_Host_DE_genes_LC_RC_padj.1.rds")
# add group pairwise contrast label
de.genes$group <- 'LC-RC'
de.genes$group <- as.factor(de.genes$group)
dim(de.genes)
de.genes$LFC <- ifelse(de.genes$log2FoldChange>0, 'Up', 'Down')
de.genes$LFC <- as.factor(de.genes$LFC)
summary_DEG <- de.genes %>% dplyr::count(group, LFC)
summary_DEG$LFC <- factor(summary_DEG$LFC, levels = c("Up", "Down"))
summary_DEG[1,3] <- summary_DEG[1,3]*(-1)
summary_DEG_3 <- summary_DEG
summary_DEG_3
# import data
de.genes <- readRDS("Sid_Host_DE_genes_OO_LO_padj.1.rds")
# add group pairwise contrast label
de.genes$group <- 'OO-LO'
de.genes$group <- as.factor(de.genes$group)
de.genes$LFC <- ifelse(de.genes$log2FoldChange>0, 'Up', 'Down')
de.genes$LFC <- as.factor(de.genes$LFC)
summary_DEG <- de.genes %>% dplyr::count(group, LFC)
summary_DEG$LFC <- factor(summary_DEG$LFC, levels = c("Up", "Down"))
summary_DEG_4a <- summary_DEG
summary_DEG_4b <- data.frame("group" = "OO-LO", "LFC" = "Down", "n" = 0)
summary_DEG_4 <- rbind(summary_DEG_4a, summary_DEG_4b)
summary_DEG_4[sapply(summary_DEG_4, is.character)] <- lapply(summary_DEG_4[sapply(summary_DEG_4, is.character)], as.factor)
summary_DEG_4
# import data
de.genes <- readRDS("Sid_Host_DE_genes_LO_RO_padj.1.rds")
# add group pairwise contrast label
de.genes$group <- 'LO-RO'
de.genes$group <- as.factor(de.genes$group)
dim(de.genes)
de.genes$LFC <- ifelse(de.genes$log2FoldChange>0, 'Up', 'Down')
de.genes$LFC <- as.factor(de.genes$LFC)
summary_DEG <- de.genes %>% dplyr::count(group, LFC)
summary_DEG$LFC <- factor(summary_DEG$LFC, levels = c("Up", "Down"))
summary_DEG[1,3] <- summary_DEG[1,3]*(-1)
summary_DEG_5 <- summary_DEG
summary_DEG_5
# import data
de.genes <- readRDS("Sid_Host_DE_genes_OO_RO_padj.1.rds")
# add group pairwise contrast label
de.genes$group <- 'OO-RO'
de.genes$group <- as.factor(de.genes$group)
dim(de.genes)
de.genes$LFC <- ifelse(de.genes$log2FoldChange>0, 'Up', 'Down')
de.genes$LFC <- as.factor(de.genes$LFC)
summary_DEG <- de.genes %>% dplyr::count(group, LFC)
summary_DEG$LFC <- factor(summary_DEG$LFC, levels = c("Up", "Down"))
summary_DEG[1,3] <- summary_DEG[1,3]*(-1)
summary_DEG_6 <- summary_DEG
summary_DEG_6
summary_DEG_7a <- data.frame("group" = "LO-LC", "LFC" = "Up", "n" = 0)
summary_DEG_7b <- data.frame("group" = "LO-LC", "LFC" = "Down", "n" = 0)
summary_DEG_7 <- rbind(summary_DEG_7a, summary_DEG_7b)
summary_DEG_7[sapply(summary_DEG_7, is.character)] <- lapply(summary_DEG_7[sapply(summary_DEG_7, is.character)], as.factor)
summary_DEG_7
# import data
de.genes <- readRDS("Sid_Host_DE_genes_OO_OC_padj.1.rds")
# add group pairwise contrast label
de.genes$group <- 'OO-OC'
de.genes$group <- as.factor(de.genes$group)
dim(de.genes)
de.genes$LFC <- ifelse(de.genes$log2FoldChange>0, 'Up', 'Down')
de.genes$LFC <- as.factor(de.genes$LFC)
summary_DEG <- de.genes %>% dplyr::count(group, LFC)
summary_DEG$LFC <- factor(summary_DEG$LFC, levels = c("Up", "Down"))
summary_DEG[1,3] <- summary_DEG[1,3]*(-1)
summary_DEG_8a <- summary_DEG
summary_DEG_8b <- data.frame("group" = "OO-OC", "LFC" = "Up", "n" = 0)
summary_DEG_8 <- rbind(summary_DEG_8a, summary_DEG_8b)
summary_DEG_8[sapply(summary_DEG_8, is.character)] <- lapply(summary_DEG_8[sapply(summary_DEG_8, is.character)], as.factor)
summary_DEG_8
# import data
de.genes <- readRDS("Sid_Host_DE_genes_RO_RC_padj.1.rds")
# add group pairwise contrast label
de.genes$group <- 'RO-RC'
de.genes$group <- as.factor(de.genes$group)
dim(de.genes)
de.genes$LFC <- ifelse(de.genes$log2FoldChange>0, 'Up', 'Down')
de.genes$LFC <- as.factor(de.genes$LFC)
summary_DEG <- de.genes %>% dplyr::count(group, LFC)
summary_DEG$LFC <- factor(summary_DEG$LFC, levels = c("Up", "Down"))
summary_DEG[1,3] <- summary_DEG[1,3]*(-1)
summary_DEG_9 <- summary_DEG
summary_DEG_9
# import data
de.genes <- readRDS("Sid_Host_DE_genes_OO_RC_padj.1.rds")
# add group pairwise contrast label
de.genes$group <- 'OO-RC'
de.genes$group <- as.factor(de.genes$group)
dim(de.genes)
de.genes$LFC <- ifelse(de.genes$log2FoldChange>0, 'Up', 'Down')
de.genes$LFC <- as.factor(de.genes$LFC)
summary_DEG <- de.genes %>% dplyr::count(group, LFC)
summary_DEG$LFC <- factor(summary_DEG$LFC, levels = c("Up", "Down"))
summary_DEG[1,3] <- summary_DEG[1,3]*(-1)
summary_DEG_10 <- summary_DEG
summary_DEG_10
# import data
de.genes <- readRDS("Sid_Host_DE_genes_OO_LC_padj.1.rds")
# add group pairwise contrast label
de.genes$group <- 'OO-LC'
de.genes$group <- as.factor(de.genes$group)
dim(de.genes)
de.genes$LFC <- ifelse(de.genes$log2FoldChange>0, 'Up', 'Down')
de.genes$LFC <- as.factor(de.genes$LFC)
summary_DEG <- de.genes %>% dplyr::count(group, LFC)
summary_DEG$LFC <- factor(summary_DEG$LFC, levels = c("Up", "Down"))
summary_DEG[1,3] <- summary_DEG[1,3]*(-1)
summary_DEG_11 <- summary_DEG
summary_DEG_11
summary2 <- rbind(summary_DEG_1, summary_DEG_2, summary_DEG_3, summary_DEG_4, summary_DEG_5, summary_DEG_6, summary_DEG_7, summary_DEG_8, summary_DEG_9)
summary2
levels(summary2$group)
#summary2$Destination <- c("Control", "Control", "Control", "Control", "Control", "Control", "Ojo", "Ojo", "Ojo", "Ojo", "Ojo", "Ojo", "Ojo vs. Control", "Ojo vs. Control", "Ojo vs. Control", "Ojo vs. Control", "Ojo vs. Control", "Ojo vs. Control")
summary2$Destination <- c("Ambient", "Ambient", "Ambient", "Ambient", "Ambient", "Ambient", "Low pH", "Low pH", "Low pH", "Low pH", "Low pH", "Low pH", "Ambient vs. Low pH", "Ambient vs. Low pH", "Ambient vs. Low pH", "Ambient vs. Low pH", "Ambient vs. Low pH", "Ambient vs. Low pH")
summary2$Destination <- as.factor(summary2$Destination)
summary2$Destination <- factor(summary2$Destination, levels = c("Ambient", "Low pH", "Ambient vs. Low pH"))
# levels(summary2$group)
# "OC-LC" "OC-RC" "LC-RC" "OO-LO" "LO-RO" "OO-RO" "LO-LC" "OO-OC" "RO-RC"
summary2$group <- revalue(summary2$group, c("OC-LC" = "Lagoon vs. Ojo", "OC-RC" = "Reef vs. Ojo", "LC-RC" = "Reef vs. Lagoon", "OO-LO" = "Lagoon vs. Ojo", "OO-RO" = "Reef vs. Ojo", "LO-LC" = "Lagoon", "OO-OC" = "Ojo", "RO-RC" = "Reef"))
summary2
plot.combo <- ggplot(summary2, aes(x = group, fill = LFC)) +
facet_wrap(~Destination, scales = "free_x") +
geom_bar(data=subset(summary2, LFC=="Up"), aes(y=n, fill = LFC), stat = "identity", width=0.6) + #, binwidth=0
geom_bar(data=subset(summary2, LFC=="Down"), aes(y=n, fill = LFC), stat = "identity", width=0.6) + #, binwidth=0
geom_text(data=subset(summary2, LFC=="Up"), aes(group, n, label = n), position = position_dodge(width=0.9), vjust = -0.5) +
geom_text(data=subset(summary2, LFC=="Down"), aes(group, n, label = -n), position = position_dodge(width=0.9), vjust = 1.5) +
scale_fill_manual("LFC", values=c("black", "#56B4E9"), labels=c("Down-regulated", "Up-regulated"), guide=guide_legend(reverse=TRUE)) + #colorblind friendly
ylab("Differentially expressed genes") +
xlab("Native") +
scale_y_continuous(limits = c(-870, 500), breaks = seq(-800, 400, by = 200)) +
theme_classic() +
theme(legend.position = "bottom", panel.background = element_rect(colour = "black"), axis.text.x = element_text(vjust = 0.5)) #axis.text.x=element_text(vjust=0.5, size=10, face="italic", angle = 45),
plot.combo
summary2 <- rbind(summary_DEG_1, summary_DEG_2, summary_DEG_3, summary_DEG_4, summary_DEG_5, summary_DEG_6, summary_DEG_7, summary_DEG_8, summary_DEG_9)
summary2
#summary2$Destination <- c("Control", "Control", "Control", "Control", "Control", "Control", "Ojo", "Ojo", "Ojo", "Ojo", "Ojo", "Ojo", "Ojo vs. Control", "Ojo vs. Control", "Ojo vs. Control", "Ojo vs. Control", "Ojo vs. Control", "Ojo vs. Control")
summary2$Destination <- c("Ambient", "Ambient", "Ambient", "Ambient", "Ambient", "Ambient", "Low pH", "Low pH", "Low pH", "Low pH", "Low pH", "Low pH", "Ambient vs. Low pH", "Ambient vs. Low pH", "Ambient vs. Low pH", "Ambient vs. Low pH", "Ambient vs. Low pH", "Ambient vs. Low pH")
summary2$Destination <- as.factor(summary2$Destination)
summary2$Destination <- factor(summary2$Destination, levels = c("Ambient", "Low pH", "Ambient vs. Low pH"))
# levels(summary2$group)
# "OC-LC" "OC-RC" "LC-RC" "OO-LO" "LO-RO" "OO-RO" "LO-LC" "OO-OC" "RO-RC"
summary2$group <- revalue(summary2$group, c("OC-LC" = "Lagoon vs. Ojo", "OC-RC" = "Reef vs. Ojo", "LC-RC" = "Reef vs. Lagoon", "OO-LO" = "Lagoon vs. Ojo", "LO-RO" = "Reef vs. Lagoon", "OO-RO" = "Reef vs. Ojo", "LO-LC" = "Lagoon", "OO-OC" = "Ojo", "RO-RC" = "Reef"))
summary2
plot.combo <- ggplot(summary2, aes(x = group, fill = LFC)) +
facet_wrap(~Destination, scales = "free_x") +
geom_bar(data=subset(summary2, LFC=="Up"), aes(y=n, fill = LFC), stat = "identity", width=0.6) + #, binwidth=0
geom_bar(data=subset(summary2, LFC=="Down"), aes(y=n, fill = LFC), stat = "identity", width=0.6) + #, binwidth=0
geom_text(data=subset(summary2, LFC=="Up"), aes(group, n, label = n), position = position_dodge(width=0.9), vjust = -0.5) +
geom_text(data=subset(summary2, LFC=="Down"), aes(group, n, label = -n), position = position_dodge(width=0.9), vjust = 1.5) +
scale_fill_manual("LFC", values=c("black", "#56B4E9"), labels=c("Down-regulated", "Up-regulated"), guide=guide_legend(reverse=TRUE)) + #colorblind friendly
ylab("Differentially expressed genes") +
xlab("Native") +
scale_y_continuous(limits = c(-870, 500), breaks = seq(-800, 400, by = 200)) +
theme_classic() +
theme(legend.position = "bottom", panel.background = element_rect(colour = "black"), axis.text.x = element_text(angle = 45, vjust = 0.5)) #axis.text.x=element_text(vjust=0.5, size=10, face="italic", angle = 45),
plot.combo
plot.combo <- ggplot(summary2, aes(x = group, fill = LFC)) +
facet_wrap(~Destination, scales = "free_x") +
geom_bar(data=subset(summary2, LFC=="Up"), aes(y=n, fill = LFC), stat = "identity", width=0.6) + #, binwidth=0
geom_bar(data=subset(summary2, LFC=="Down"), aes(y=n, fill = LFC), stat = "identity", width=0.6) + #, binwidth=0
geom_text(data=subset(summary2, LFC=="Up"), aes(group, n, label = n), position = position_dodge(width=0.9), vjust = -0.5) +
geom_text(data=subset(summary2, LFC=="Down"), aes(group, n, label = -n), position = position_dodge(width=0.9), vjust = 1.5) +
scale_fill_manual("LFC", values=c("black", "#56B4E9"), labels=c("Down-regulated", "Up-regulated"), guide=guide_legend(reverse=TRUE)) + #colorblind friendly
ylab("Differentially expressed genes") +
xlab("Native") +
scale_y_continuous(limits = c(-870, 500), breaks = seq(-800, 400, by = 200)) +
theme_classic() +
theme(legend.position = "none", panel.background = element_rect(colour = "black"), axis.text.x = element_text(angle = 45, vjust = 0.5)) #axis.text.x=element_text(vjust=0.5, size=10, face="italic", angle = 45),
plot.combo
# save plot
ggsave("Sid_Host_DEG_barplot_Low-pH-label.pdf", plot = plot.combo,  width = 6, height = 3, units = "in", dpi = 1200) #width = 6.5, height = 4.5
# save plot
ggsave("Sid_Host_DEG_barplot_Low-pH-label.pdf", plot = plot.combo,  width = 6, height = 3.2, units = "in", dpi = 1200) #width = 6.5, height = 4.5
plot.combo <- ggplot(summary2, aes(x = group, fill = LFC)) +
facet_wrap(~Destination, scales = "free_x") +
geom_bar(data=subset(summary2, LFC=="Up"), aes(y=n, fill = LFC), stat = "identity", width=0.6) + #, binwidth=0
geom_bar(data=subset(summary2, LFC=="Down"), aes(y=n, fill = LFC), stat = "identity", width=0.6) + #, binwidth=0
geom_text(data=subset(summary2, LFC=="Up"), aes(group, n, label = n), position = position_dodge(width=0.9), vjust = -0.5) +
geom_text(data=subset(summary2, LFC=="Down"), aes(group, n, label = -n), position = position_dodge(width=0.9), vjust = 1.5) +
scale_fill_manual("LFC", values=c("black", "#56B4E9"), labels=c("Down-regulated", "Up-regulated"), guide=guide_legend(reverse=TRUE)) + #colorblind friendly
ylab("Differentially expressed genes") +
xlab("Native") +
scale_y_continuous(limits = c(-870, 500), breaks = seq(-800, 400, by = 200)) +
theme_classic() +
theme(legend.position = "none", panel.background = element_rect(colour = "black"), axis.text.x = element_text(angle = 45, vjust = 0.5)) #axis.text.x=element_text(vjust=0.5, size=10, face="italic", angle = 45),
plot.combo
# save plot
ggsave("Sid_Host_DEG_barplot_Low-pH-label.pdf", plot = plot.combo,  width = 6, height = 3.5, units = "in", dpi = 1200) #width = 6.5, height = 4.5
library(DESeq2)
library(ggplot2)
library(tidyverse)
library(dplyr)
library(plyr)
library(data.table)
library(cowplot)
library(vegan)
library(RColorBrewer)
#library(devtools)
#install_github("pmartinezarbizu/pairwiseAdonis/pairwiseAdonis")
library(pairwiseAdonis)
# cite: Martinez Arbizu, P. (2020). pairwiseAdonis: Pairwise multilevel comparison using adonis. R package version 0.4
# https://github.com/katiejolly/nationalparkcolors
#devtools::install_github("katiejolly/nationalparkcolors")
library(nationalparkcolors) #palettes
names(park_palettes)
# check palette
pal <- park_palette("Arches")
pal
# select palette
chosen.palette <- palette(park_palette("Arches")) #BlueRidgePkwy
alt.palette <- c("#8c510a", "#d8b365", "#f6e8c3", "#c7eae5", "#5ab4ac", "#01665e")
setwd("~/Documents/Rprojects/postdoc\ Rprojects/ODU_postdoc_Rprojects/Paper_Ojo_gene-expression/Porites_astreoides/host/")
meta <- read.csv("~/Documents/Rprojects/postdoc\ Rprojects/ODU_postdoc_Rprojects/Paper_Ojo_gene-expression/Porites_astreoides/P_astreoides_Year-2_metadata.csv", header=TRUE, row.names=1)
# Remove all samples that were transplanted to the Destination Ojo.Norte
# There is no control site for Norte Ojo
# For now, we are focused on samples transplanted to Laja Control or Laja Ojo sites
# This is consistent with analyses for the other 2 species in the experiment
# Also, group sample size is too small for Ojo.Norte destination
meta <- subset(meta, Destination_name != "Ojo.Norte")
meta$Destination_type <- revalue(meta$Destination_type, c("control" = "Control", "ojo" = "Ojo"))
meta$Origin_type <- revalue(meta$Origin_type, c("control" = "Lagoon", "ojo" = "Ojo"))
meta <- meta %>% unite(group, Origin_type, Destination_type, sep = ".", remove = FALSE)
meta[sapply(meta, is.character)] <- lapply(meta[sapply(meta, is.character)],
as.factor)
# Colony_ID is equivalent to genotype
meta$Colony_ID <- as.factor(meta$Colony_ID)
meta <- meta %>% unite(colony_sample, Origin_type, Destination_type, Colony_ID, id, sep = ".", remove = FALSE)
levels(meta$group)
meta <- dplyr::select(meta, Colony_ID, group, Origin_name, Origin_type, Destination_name, Destination_type, pH_Destination, colony_sample)
drop <- c("NC_292_La_Pa_yr2", "NC_320_La_Pa_yr2", "NC_311_La_Pa_yr2")
meta <- meta[!(row.names(meta) %in% drop),]
meta <- droplevels(meta)
dim(meta)
meta %>%
group_by(group) %>%
dplyr::summarise(count = n())
norm.genes <- readRDS(file = "counts_normalized_Past_Host.rds")
norm.genes <- as.data.frame.array(norm.genes)
all(colnames(norm.genes) %in% rownames(meta))
all(colnames(norm.genes) == rownames(meta))
# If your data did not match, you could use the match() function to rearrange them to be matching.
counts.transformed.vst <- readRDS(file = "counts_vst.BlindFalse_Past_Host.rds")
de.genes.LO_LC <- readRDS(file = "Past_Host_LO_LC_pval.05.rds")
de.genes.LO_LC <- as.data.frame(de.genes.LO_LC)
dim(de.genes.LO_LC)
de.genes.OO_LO <- readRDS(file = "Past_Host_OO_LO_pval.05.rds")
de.genes.OO_LO <- as.data.frame(de.genes.OO_LO)
dim(de.genes.OO_LO)
de.genes.OO_OC <- readRDS(file = "Past_Host_OO_OC_pval.05.rds")
de.genes.OO_OC <- as.data.frame(de.genes.OO_OC)
dim(de.genes.OO_OC)
de.genes.OC_LC <- readRDS(file = "Past_Host_OC_LC_pval.05.rds")
de.genes.OC_LC <- as.data.frame(de.genes.OC_LC)
dim(de.genes.OC_LC)
# extract row names from DE gene list
rownames(de.genes.OO_OC) <- de.genes.OO_OC[,1]
sigChanges <- rownames(de.genes.OO_OC)[de.genes.OO_OC$pvalue < 0.05 & !is.na(de.genes.OO_OC$pvalue)]
counts_de <- counts.transformed.vst[rownames(counts.transformed.vst) %in% sigChanges,]
dim(counts_de)
# extract row names from DE gene list
rownames(de.genes.OO_OC) <- de.genes.OO_OC[,1]
sigChanges <- rownames(de.genes.OO_OC)[de.genes.OO_OC$pvalue < 0.05 & !is.na(de.genes.OO_OC$pvalue)]
# select relevant sample columns for the given pairwise comparison
colnames(counts.transformed.vst)
counts_de <- counts.transformed.vst[,c(10:16,22:29)]
counts_de <- counts_de[rownames(counts.transformed.vst) %in% sigChanges,]
dim(counts_de)
# save plot
pdf("Past_Host_PCA_OO_OC_subset.pdf")
pcadata = DESeq2::plotPCA(counts_de, intgroup = c("group"), returnData = TRUE)
percentVar = round(100 * attr(pcadata, "percentVar"))
pca = prcomp(t(assay(counts_de)), center = TRUE, scale. = FALSE)
plot <- DESeq2::plotPCA(counts_de, returnData = TRUE, intgroup = c("group")) %>%
ggplot(aes(x = PC1, y = PC2)) +
geom_point(aes(color = group), size = 1.3) +
stat_ellipse(geom = "polygon", alpha = 1/10, aes(fill = group)) +
scale_color_manual(values = c("dodgerblue", "gold2", "#163343", "firebrick", "forestgreen", "bisque3")) + #chosen.palette
scale_fill_manual(values = c("dodgerblue", "gold2", "#163343", "firebrick", "forestgreen", "bisque3")) +
xlab(paste0("PC1: ",percentVar[1],"% variance")) +
ylab(paste0("PC2: ",percentVar[2],"% variance")) +
labs(title = "Ojo-Ojo vs. Ojo-Control (1142 genes)") +
labs(color = "Origin.Destination", fill = "Origin.Destination") +
theme_cowplot()
plot
dev.off()
rm(list=ls())
